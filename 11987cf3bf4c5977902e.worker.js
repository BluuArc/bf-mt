(function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="faa7")})({"74ce":function(e,t,n){"use strict";(function(e){var n=Object.keys,r=Array.isArray,i="undefined"!==typeof self?self:"undefined"!==typeof window?window:e;function o(e,t){return"object"!==typeof t||n(t).forEach((function(n){e[n]=t[n]})),e}var u=Object.getPrototypeOf,a={}.hasOwnProperty;function c(e,t){return a.call(e,t)}function s(e,t){"function"===typeof t&&(t=t(u(e))),n(t).forEach((function(n){f(e,n,t[n])}))}var l=Object.defineProperty;function f(e,t,n,r){l(e,t,o(n&&c(n,"get")&&"function"===typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function h(e){return{from:function(t){return e.prototype=Object.create(t.prototype),f(e.prototype,"constructor",e),{extend:s.bind(null,e.prototype)}}}}var d=Object.getOwnPropertyDescriptor;function v(e,t){var n,r=d(e,t);return r||(n=u(e))&&v(n,t)}var p=[].slice;function y(e,t,n){return p.call(e,t,n)}function m(e,t){return t(e)}function g(e){if(!e)throw new Error("Assertion Failed")}function b(e){i.setImmediate?setImmediate(e):setTimeout(e,0)}function _(e,t){return e.reduce((function(e,n,r){var i=t(n,r);return i&&(e[i[0]]=i[1]),e}),{})}function F(e,t){return function(){try{e.apply(this,arguments)}catch(n){t(n)}}}function w(e,t,n){try{e.apply(null,n)}catch(r){t&&t(r)}}function k(e,t){if(c(e,t))return e[t];if(!t)return e;if("string"!==typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=k(e,t[r]);n.push(o)}return n}var u=t.indexOf(".");if(-1!==u){var a=e[t.substr(0,u)];return void 0===a?void 0:k(a,t.substr(u+1))}}function E(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!==typeof t&&"length"in t){g("string"!==typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)E(e,t[r],n[r])}else{var o=t.indexOf(".");if(-1!==o){var u=t.substr(0,o),a=t.substr(o+1);if(""===a)void 0===n?delete e[u]:e[u]=n;else{var c=e[u];c||(c=e[u]={}),E(c,a,n)}}else void 0===n?delete e[t]:e[t]=n}}function U(e,t){"string"===typeof t?E(e,t,void 0):"length"in t&&[].map.call(t,(function(t){E(e,t,void 0)}))}function B(e){var t={};for(var n in e)c(e,n)&&(t[n]=e[n]);return t}var O=[].concat;function A(e){return O.apply([],e)}var D="Boolean,String,Date,RegExp,Blob,File,FileList,ArrayBuffer,DataView,Uint8ClampedArray,ImageData,Map,Set".split(",").concat(A([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return i[e]})).map((function(e){return i[e]}));function x(e){if(!e||"object"!==typeof e)return e;var t;if(r(e)){t=[];for(var n=0,i=e.length;n<i;++n)t.push(x(e[n]))}else if(D.indexOf(e.constructor)>=0)t=e;else for(var o in t=e.constructor?Object.create(e.constructor.prototype):{},e)c(e,o)&&(t[o]=x(e[o]));return t}function P(e,t,r,i){return r=r||{},i=i||"",n(e).forEach((function(n){if(c(t,n)){var o=e[n],u=t[n];"object"===typeof o&&"object"===typeof u&&o&&u&&""+o.constructor===""+u.constructor?P(o,u,r,i+n+"."):o!==u&&(r[i+n]=t[n])}else r[i+n]=void 0})),n(t).forEach((function(n){c(e,n)||(r[i+n]=t[n])})),r}var S="undefined"!==typeof Symbol&&Symbol.iterator,T=S?function(e){var t;return null!=e&&(t=e[S])&&t.apply(e)}:function(){return null},R={};function I(e){var t,n,i,o;if(1===arguments.length){if(r(e))return e.slice();if(this===R&&"string"===typeof e)return[e];if(o=T(e)){n=[];while(i=o.next(),!i.done)n.push(i.value);return n}if(null==e)return[e];if(t=e.length,"number"===typeof t){n=new Array(t);while(t--)n[t]=e[t];return n}return[e]}t=arguments.length,n=new Array(t);while(t--)n[t]=arguments[t];return n}var j="undefined"!==typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function N(e,t){j=e,C=t}var C=function(){return!0},L=!new Error("").stack;function K(){if(L)try{throw K.arguments,new Error}catch(e){return e}return new Error}function M(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(C).map((function(e){return"\n"+e})).join("")):""}function W(e,t){return function(){return console.warn(e+" is deprecated. See https://github.com/dfahlander/Dexie.js/wiki/Deprecations. "+M(K(),1)),t.apply(this,arguments)}}var H=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],G=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],q=H.concat(G),V={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed"};function z(e,t){this._e=K(),this.name=e,this.message=t}function Y(e,t){return e+". Errors: "+t.map((function(e){return e.toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function Q(e,t,n,r){this._e=K(),this.failures=t,this.failedKeys=r,this.successCount=n}function X(e,t){this._e=K(),this.name="BulkError",this.failures=t,this.message=Y(e,t)}h(z).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+M(this._e,2))}},toString:function(){return this.name+": "+this.message}}),h(Q).from(z),h(X).from(z);var J=q.reduce((function(e,t){return e[t]=t+"Error",e}),{}),$=z,Z=q.reduce((function(e,t){var n=t+"Error";function r(e,r){this._e=K(),this.name=n,e?"string"===typeof e?(this.message=e,this.inner=r||null):"object"===typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=V[t]||n,this.inner=null)}return h(r).from($),e[t]=r,e}),{});Z.Syntax=SyntaxError,Z.Type=TypeError,Z.Range=RangeError;var ee=G.reduce((function(e,t){return e[t+"Error"]=Z[t],e}),{});function te(e,t){if(!e||e instanceof z||e instanceof TypeError||e instanceof SyntaxError||!e.name||!ee[e.name])return e;var n=new ee[e.name](t||e.message,e);return"stack"in e&&f(n,"stack",{get:function(){return this.inner.stack}}),n}var ne=q.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=Z[t]),e}),{});function re(){}function ie(e){return e}function oe(e,t){return null==e||e===ie?t:function(n){return t(e(n))}}function ue(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ae(e,t){return e===re?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ue(r,this.onsuccess):r),i&&(this.onerror=this.onerror?ue(i,this.onerror):i),void 0!==o?o:n}}function ce(e,t){return e===re?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ue(n,this.onsuccess):n),r&&(this.onerror=this.onerror?ue(r,this.onerror):r)}}function se(e,t){return e===re?t:function(n){var r=e.apply(this,arguments);o(n,r);var i=this.onsuccess,u=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?ue(i,this.onsuccess):i),u&&(this.onerror=this.onerror?ue(u,this.onerror):u),void 0===r?void 0===a?void 0:a:o(r,a)}}function le(e,t){return e===re?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function fe(e,t){return e===re?t:function(){var n=e.apply(this,arguments);if(n&&"function"===typeof n.then){var r=this,i=arguments.length,o=new Array(i);while(i--)o[i]=arguments[i];return n.then((function(){return t.apply(r,o)}))}return t.apply(this,arguments)}}ne.ModifyError=Q,ne.DexieError=z,ne.BulkError=X;var he={},de=100,ve=20,pe=7,ye=function(){try{return new Function("let F=async ()=>{},p=F();return [p,Object.getPrototypeOf(p),Promise.resolve(),F.constructor];")()}catch(t){var e=i.Promise;return e?[e.resolve(),e.prototype,e.resolve()]:[]}}(),me=ye[0],ge=ye[1],be=ye[2],_e=ge&&ge.then,Fe=me&&me.constructor,we=ye[3],ke=!!be,Ee=!1,Ue=be?function(){be.then(Ye)}:i.setImmediate?setImmediate.bind(null,Ye):i.MutationObserver?function(){var e=document.createElement("div");new MutationObserver((function(){Ye(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(Ye,0)},Be=function(e,t){Ie.push([e,t]),Ae&&(Ue(),Ae=!1)},Oe=!0,Ae=!0,De=[],xe=[],Pe=null,Se=ie,Te={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:wt,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(e){try{wt(e[0],e[1])}catch(t){}}))}},Re=Te,Ie=[],je=0,Ne=[];function Ce(e){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=re,this._lib=!1;var t=this._PSD=Re;if(j&&(this._stackHolder=K(),this._prev=null,this._numPrev=0),"function"!==typeof e){if(e!==he)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&We(this,this._value))}this._state=null,this._value=null,++t.ref,Me(this,e)}var Le={get:function(){var e=Re,t=at;function n(n,r){var i=this,o=!e.global&&(e!==Re||t!==at);o&&ft();var u=new Ce((function(t,u){Ge(i,new Ke(bt(n,e,o),bt(r,e,o),t,u,e))}));return j&&ze(u,this),u}return n.prototype=he,n},set:function(e){f(this,"then",e&&e.prototype===he?Le:{get:function(){return e},set:Le.set})}};function Ke(e,t,n,r,i){this.onFulfilled="function"===typeof e?e:null,this.onRejected="function"===typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function Me(e,t){try{t((function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Qe();t&&"function"===typeof t.then?Me(e,(function(e,n){t instanceof Ce?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,He(e)),n&&Xe()}}),We.bind(null,e))}catch(n){We(e,n)}}function We(e,t){if(xe.push(t),null===e._state){var n=e._lib&&Qe();t=Se(t),e._state=!1,e._value=t,j&&null!==t&&"object"===typeof t&&!t._promise&&w((function(){var n=v(t,"stack");t._promise=e,f(t,"stack",{get:function(){return Ee?n&&(n.get?n.get.apply(t):n.value):e.stack}})})),Ze(e),He(e),n&&Xe()}}function He(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Ge(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===je&&(++je,Be((function(){0===--je&&Je()}),[]))}function Ge(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++je,Be(qe,[n,e,t])}else e._listeners.push(t)}function qe(e,t,n){try{Pe=t;var r,i=t._value;t._state?r=e(i):(xe.length&&(xe=[]),r=e(i),-1===xe.indexOf(i)&&et(t)),n.resolve(r)}catch(o){n.reject(o)}finally{Pe=null,0===--je&&Je(),--n.psd.ref||n.psd.finalize()}}function Ve(e,t,n){if(t.length===n)return t;var r="";if(!1===e._state){var i,o,u=e._value;null!=u?(i=u.name||"Error",o=u.message||u,r=M(u,0)):(i=u,o=""),t.push(i+(o?": "+o:"")+r)}return j&&(r=M(e._stackHolder,2),r&&-1===t.indexOf(r)&&t.push(r),e._prev&&Ve(e._prev,t,n)),t}function ze(e,t){var n=t?t._numPrev+1:0;n<de&&(e._prev=t,e._numPrev=n)}function Ye(){Qe()&&Xe()}function Qe(){var e=Oe;return Oe=!1,Ae=!1,e}function Xe(){var e,t,n;do{while(Ie.length>0)for(e=Ie,Ie=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(Ie.length>0);Oe=!0,Ae=!0}function Je(){var e=De;De=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));var t=Ne.slice(0),n=t.length;while(n)t[--n]()}function $e(e){function t(){e(),Ne.splice(Ne.indexOf(t),1)}Ne.push(t),++je,Be((function(){0===--je&&Je()}),[])}function Ze(e){De.some((function(t){return t._value===e._value}))||De.push(e)}function et(e){var t=De.length;while(t)if(De[--t]._value===e._value)return void De.splice(t,1)}function tt(e){return new Ce(he,!1,e)}function nt(e,t){var n=Re;return function(){var r=Qe(),i=Re;try{return pt(n,!0),e.apply(this,arguments)}catch(o){t&&t(o)}finally{pt(i,!1),r&&Xe()}}}s(Ce.prototype,{then:Le,_then:function(e,t){Ge(this,new Ke(null,null,e,t,Re))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"===typeof t?this.then(null,(function(e){return e instanceof t?n(e):tt(e)})):this.then(null,(function(e){return e&&e.name===t?n(e):tt(e)}))},finally:function(e){return this.then((function(t){return e(),t}),(function(t){return e(),tt(t)}))},stack:{get:function(){if(this._stack)return this._stack;try{Ee=!0;var e=Ve(this,[],ve),t=e.join("\nFrom previous: ");return null!==this._state&&(this._stack=t),t}finally{Ee=!1}}},timeout:function(e,t){var n=this;return e<1/0?new Ce((function(r,i){var o=setTimeout((function(){return i(new Z.Timeout(t))}),e);n.then(r,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!==typeof Symbol&&Symbol.toStringTag&&f(Ce.prototype,Symbol.toStringTag,"Promise"),Te.env=yt(),s(Ce,{all:function(){var e=I.apply(null,arguments).map(ht);return new Ce((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((function(i,o){return Ce.resolve(i).then((function(n){e[o]=n,--r||t(e)}),n)}))}))},resolve:function(e){if(e instanceof Ce)return e;if(e&&"function"===typeof e.then)return new Ce((function(t,n){e.then(t,n)}));var t=new Ce(he,!0,e);return ze(t,Pe),t},reject:tt,race:function(){var e=I.apply(null,arguments).map(ht);return new Ce((function(t,n){e.map((function(e){return Ce.resolve(e).then(t,n)}))}))},PSD:{get:function(){return Re},set:function(e){return Re=e}},newPSD:st,usePSD:mt,scheduler:{get:function(){return Be},set:function(e){Be=e}},rejectionMapper:{get:function(){return Se},set:function(e){Se=e}},follow:function(e,t){return new Ce((function(n,r){return st((function(t,n){var r=Re;r.unhandleds=[],r.onunhandled=n,r.finalize=ue((function(){var e=this;$e((function(){0===e.unhandleds.length?t():n(e.unhandleds[0])}))}),r.finalize),e()}),t,n,r)}))}});var rt={awaits:0,echoes:0,id:0},it=0,ot=[],ut=0,at=0,ct=0;function st(e,t,n,r){var i=Re,u=Object.create(i);u.parent=i,u.ref=0,u.global=!1,u.id=++ct;var a=Te.env;u.env=ke?{Promise:Ce,PromiseProp:{value:Ce,configurable:!0,writable:!0},all:Ce.all,race:Ce.race,resolve:Ce.resolve,reject:Ce.reject,nthen:_t(a.nthen,u),gthen:_t(a.gthen,u)}:{},t&&o(u,t),++i.ref,u.finalize=function(){--this.parent.ref||this.parent.finalize()};var c=mt(u,e,n,r);return 0===u.ref&&u.finalize(),c}function lt(){return rt.id||(rt.id=++it),++rt.awaits,rt.echoes+=pe,rt.id}function ft(e){!rt.awaits||e&&e!==rt.id||(0===--rt.awaits&&(rt.id=0),rt.echoes=rt.awaits*pe)}function ht(e){return rt.echoes&&e&&e.constructor===Fe?(lt(),e.then((function(e){return ft(),e}),(function(e){return ft(),kt(e)}))):e}function dt(e){++at,rt.echoes&&0!==--rt.echoes||(rt.echoes=rt.id=0),ot.push(Re),pt(e,!0)}function vt(){var e=ot[ot.length-1];ot.pop(),pt(e,!1)}function pt(e,t){var n=Re;if((t?!rt.echoes||ut++&&e===Re:!ut||--ut&&e===Re)||gt(t?dt.bind(null,e):vt),e!==Re&&(Re=e,n===Te&&(Te.env=yt()),ke)){var r=Te.env.Promise,o=e.env;ge.then=o.nthen,r.prototype.then=o.gthen,(n.global||e.global)&&(Object.defineProperty(i,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject)}}function yt(){var e=i.Promise;return ke?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:e.all,race:e.race,resolve:e.resolve,reject:e.reject,nthen:ge.then,gthen:e.prototype.then}:{}}function mt(e,t,n,r,i){var o=Re;try{return pt(e,!0),t(n,r,i)}finally{pt(o,!1)}}function gt(e){_e.call(me,e)}function bt(e,t,n){return"function"!==typeof e?e:function(){var r=Re;n&&lt(),pt(t,!0);try{return e.apply(this,arguments)}finally{pt(r,!1)}}}function _t(e,t){return function(n,r){return e.call(this,bt(n,t,!1),bt(r,t,!1))}}var Ft="unhandledrejection";function wt(e,t){var n;try{n=t.onuncatched(e)}catch(a){}if(!1!==n)try{var r,u={promise:t,reason:e};if(i.document&&document.createEvent?(r=document.createEvent("Event"),r.initEvent(Ft,!0,!0),o(r,u)):i.CustomEvent&&(r=new CustomEvent(Ft,{detail:u}),o(r,u)),r&&i.dispatchEvent&&(dispatchEvent(r),!i.PromiseRejectionEvent&&i.onunhandledrejection))try{i.onunhandledrejection(r)}catch(c){}r.defaultPrevented||console.warn("Unhandled rejection: "+(e.stack||e))}catch(a){}}var kt=Ce.reject;function Et(e){var t={},i=function(n,r){if(r){var i=arguments.length,o=new Array(i-1);while(--i)o[i-1]=arguments[i];return t[n].subscribe.apply(null,o),e}if("string"===typeof n)return t[n]};i.addEventType=a;for(var o=1,u=arguments.length;o<u;++o)a(arguments[o]);return i;function a(e,n,r){if("object"===typeof e)return c(e);n||(n=le),r||(r=re);var o={subscribers:[],fire:r,subscribe:function(e){-1===o.subscribers.indexOf(e)&&(o.subscribers.push(e),o.fire=n(o.fire,e))},unsubscribe:function(e){o.subscribers=o.subscribers.filter((function(t){return t!==e})),o.fire=o.subscribers.reduce(n,r)}};return t[e]=i[e]=o,o}function c(e){n(e).forEach((function(t){var n=e[t];if(r(n))a(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new Z.InvalidArgument("Invalid event config");var i=a(t,ie,(function(){var e=arguments.length,t=new Array(e);while(e--)t[e]=arguments[e];i.subscribers.forEach((function(e){b((function(){e.apply(null,t)}))}))}))}}))}}var Ut,Bt="{version}",Ot=String.fromCharCode(65535),At=function(){try{return IDBKeyRange.only([[]]),[[]]}catch(e){return Ot}}(),Dt=-1/0,xt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Pt="String expected.",St=[],Tt="undefined"!==typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Rt=Tt,It=Tt,jt=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)};function Nt(e,t){var u,a,l,h=Nt.dependencies,d=o({addons:Nt.addons,autoOpen:!0,indexedDB:h.indexedDB,IDBKeyRange:h.IDBKeyRange},t),v=d.addons,p=d.autoOpen,b=d.indexedDB,U=d.IDBKeyRange,O=this._dbSchema={},D=[],S=[],T={},N=null,C=null,L=!1,M=null,H=!1,G="readonly",q="readwrite",V=this,z=new Ce((function(e){u=e})),Y=new Ce((function(e,t){a=t})),J=!0,$=!!Qt(b);function ee(){V.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '"+V.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+V.name+"'. Closing db now to resume the delete request."),V.close()})),V.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+V.name+"') was blocked"):console.warn("Upgrade '"+V.name+"' blocked by other connection holding version "+e.oldVersion/10)}))}function te(e){this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null},this.stores({})}function ne(e,t,r){var i=V._createTransaction(q,S,O);i.create(t),i._completion.catch(r);var o=i._reject.bind(i);st((function(){Re.trans=i,0===e?(n(O).forEach((function(e){he(t,e,O[e].primKey,O[e].indexes)})),Ce.follow((function(){return V.on.populate.fire(i)})).catch(o)):ue(e,i,t).catch(o)}))}function ue(e,t,n){var r=[],i=D.filter((function(t){return t._cfg.version===e}))[0];if(!i)throw new Z.Upgrade("Dexie specification of currently installed DB version is missing");O=V._dbSchema=i._cfg.dbschema;var o=!1,u=D.filter((function(t){return t._cfg.version>e}));function a(){return r.length?Ce.resolve(r.shift()(t.idbtrans)).then(a):Ce.resolve()}return u.forEach((function(e){r.push((function(){var r=O,i=e._cfg.dbschema;He(r,n),He(i,n),O=V._dbSchema=i;var u=le(r,i);if(u.add.forEach((function(e){he(n,e[0],e[1].primKey,e[1].indexes)})),u.change.forEach((function(e){if(e.recreate)throw new Z.Upgrade("Not yet support for changing primary key");var t=n.objectStore(e.name);e.add.forEach((function(e){pe(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),pe(t,e)})),e.del.forEach((function(e){t.deleteIndex(e)}))})),e._cfg.contentUpgrade)return o=!0,Ce.follow((function(){e._cfg.contentUpgrade(t)}))})),r.push((function(t){if(!o||!Rt){var n=e._cfg.dbschema;ve(n,t)}}))})),a().then((function(){de(O,n)}))}function le(e,t){var n={del:[],add:[],change:[]};for(var r in e)t[r]||n.del.push(r);for(r in t){var i=e[r],o=t[r];if(i){var u={name:r,def:o,recreate:!1,del:[],add:[],change:[]};if(i.primKey.src!==o.primKey.src)u.recreate=!0,n.change.push(u);else{var a=i.idxByName,c=o.idxByName;for(var s in a)c[s]||u.del.push(s);for(s in c){var l=a[s],f=c[s];l?l.src!==f.src&&u.change.push(f):u.add.push(f)}(u.del.length>0||u.add.length>0||u.change.length>0)&&n.change.push(u)}}else n.add.push([r,o])}return n}function he(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((function(e){pe(i,e)})),i}function de(e,t){n(e).forEach((function(n){t.db.objectStoreNames.contains(n)||he(t,n,e[n].primKey,e[n].indexes)}))}function ve(e,t){for(var n=0;n<t.db.objectStoreNames.length;++n){var r=t.db.objectStoreNames[n];null==e[r]&&t.db.deleteObjectStore(r)}}function pe(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function ye(e,t,n){if(H||Re.letThrough){var r=V._createTransaction(e,t,O);try{r.create()}catch(i){return kt(i)}return r._promise(e,(function(e,t){return st((function(){return Re.trans=r,n(e,t,r)}))})).then((function(e){return r._completion.then((function(){return e}))}))}if(!L){if(!p)return kt(new Z.DatabaseClosed);V.open().catch(re)}return z.then((function(){return ye(e,t,n)}))}function me(e,t,n){var r=arguments.length;if(r<2)throw new Z.InvalidArgument("Too few arguments");var i=new Array(r-1);while(--r)i[r-1]=arguments[r];n=i.pop();var o=A(i);return[e,o,n]}function ge(e,t,n){this.name=e,this.schema=t,this._tx=n,this.hook=T[e]?T[e].hook:Et(null,{creating:[ae,re],reading:[oe,ie],updating:[se,re],deleting:[ce,re]})}function be(e,t,n){return(n?Ht:Mt)((function(n){e.push(n),t&&t()}))}function _e(e,t,n,r,i){return new Ce((function(o,u){var a=n.length,c=a-1;if(0===a)return o();if(r){var s,l=Ht(u),f=Kt(null);w((function(){for(var r=0;r<a;++r){s={onsuccess:null,onerror:null};var u=n[r];i.call(s,u[0],u[1],t);var h=e.delete(u[0]);h._hookCtx=s,h.onerror=l,h.onsuccess=r===c?Kt(o):f}}),(function(e){throw s.onerror&&s.onerror(e),e}))}else for(var h=0;h<a;++h){var d=e.delete(n[h]);d.onerror=Mt(u),h===c&&(d.onsuccess=nt((function(){return o()})))}}))}function ke(e,t,n,r){var i=this;this.db=V,this.mode=e,this.storeNames=t,this.idbtrans=null,this.on=Et(this,"complete","error","abort"),this.parent=r||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ce((function(e,t){i._resolve=e,i._reject=t})),this._completion.then((function(){i.active=!1,i.on.complete.fire()}),(function(e){var t=i.active;return i.active=!1,i.on.error.fire(e),i.parent?i.parent._reject(e):t&&i.idbtrans&&i.idbtrans.abort(),kt(e)}))}function Ee(e,t,n){this._ctx={table:e,index:":id"===t?null:t,or:n}}function Ue(e,t){var n=null,r=null;if(t)try{n=t()}catch(u){r=u}var i=e._ctx,o=i.table;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:o.hook.reading.fire}}function Be(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Oe(e,t){return e._cfg.version-t._cfg.version}function Ae(e,t,n){t.forEach((function(t){var r=n[t];e.forEach((function(e){t in e||(e===ke.prototype||e instanceof ke?f(e,t,{get:function(){return this.table(t)}}):e[t]=new ge(t,r))}))}))}function De(e){e.forEach((function(e){for(var t in e)e[t]instanceof ge&&delete e[t]}))}function xe(e,t,n,r,i,o){var u=o?function(e,t,r){return n(o(e),t,r)}:n,a=nt(u,i);e.onerror||(e.onerror=Mt(i)),e.onsuccess=F(t?function(){var n=e.result;if(n){var o=function(){n.continue()};t(n,(function(e){o=e}),r,i)&&a(n.value,n,(function(e){o=e})),o()}else r()}:function(){var t=e.result;if(t){var n=function(){t.continue()};a(t.value,t,(function(e){n=e})),n()}else r()},i)}function Pe(e){var t=[];return e.split(",").forEach((function(e){e=e.trim();var n=e.replace(/([&*]|\+\+)/g,""),i=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;t.push(new Vt(n,i||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),r(i),/\./.test(e)))})),t}function Se(e,t){return b.cmp(e,t)}function Te(e,t){return Se(e,t)<0?e:t}function Ie(e,t){return Se(e,t)>0?e:t}function je(e,t){return b.cmp(e,t)}function Ne(e,t){return b.cmp(t,e)}function Le(e,t){return e<t?-1:e===t?0:1}function Ke(e,t){return e>t?-1:e===t?0:1}function Me(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}function We(){if(V.verno=N.version/10,V._dbSchema=O={},S=y(N.objectStoreNames,0),0!==S.length){var e=N.transaction(Yt(S),"readonly");S.forEach((function(t){for(var n=e.objectStore(t),r=n.keyPath,i=r&&"string"===typeof r&&-1!==r.indexOf("."),o=new Vt(r,r||"",!1,!1,!!n.autoIncrement,r&&"string"!==typeof r,i),u=[],a=0;a<n.indexNames.length;++a){var c=n.index(n.indexNames[a]);r=c.keyPath,i=r&&"string"===typeof r&&-1!==r.indexOf(".");var s=new Vt(c.name,r,!!c.unique,!!c.multiEntry,!1,r&&"string"!==typeof r,i);u.push(s)}O[t]=new zt(t,o,u,{})})),Ae([T],n(O),O)}}function He(e,t){for(var n=t.db.objectStoreNames,r=0;r<n.length;++r){var o=n[r],u=t.objectStore(o);l="getAll"in u;for(var a=0;a<u.indexNames.length;++a){var c=u.indexNames[a],s=u.index(c).keyPath,f="string"===typeof s?s:"["+y(s).join("+")+"]";if(e[o]){var h=e[o].idxByName[f];h&&(h.name=c)}}}/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(l=!1)}function Ge(e){V.on("blocked").fire(e),St.filter((function(e){return e.name===V.name&&e!==V&&!e._vcFired})).map((function(t){return t.on("versionchange").fire(e)}))}this.version=function(e){if(N||L)throw new Z.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=D.filter((function(t){return t._cfg.version===e}))[0];return t||(t=new te(e),D.push(t),D.sort(Oe),J=!1,t)},o(te.prototype,{stores:function(e){this._cfg.storesSource=this._cfg.storesSource?o(this._cfg.storesSource,e):e;var t={};D.forEach((function(e){o(t,e._cfg.storesSource)}));var r=this._cfg.dbschema={};return this._parseStoresSpec(t,r),O=V._dbSchema=r,De([T,V,ke.prototype]),Ae([T,V,ke.prototype,this._cfg.tables],n(r),r),S=n(r),this},upgrade:function(e){return this._cfg.contentUpgrade=e,this},_parseStoresSpec:function(e,t){n(e).forEach((function(n){if(null!==e[n]){var r={},i=Pe(e[n]),o=i.shift();if(o.multi)throw new Z.Schema("Primary key cannot be multi-valued");o.keyPath&&E(r,o.keyPath,o.auto?0:o.keyPath),i.forEach((function(e){if(e.auto)throw new Z.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new Z.Schema("Index must have a name and cannot be an empty string");E(r,e.keyPath,e.compound?e.keyPath.map((function(){return""})):"")})),t[n]=new zt(n,o,i,r)}}))}}),this._allTables=T,this._createTransaction=function(e,t,n,r){return new ke(e,t,n,r)},this._whenReady=function(e){return H||Re.letThrough?e():new Ce((function(e,t){if(!L){if(!p)return void t(new Z.DatabaseClosed);V.open().catch(re)}z.then(e,t)})).then(e)},this.verno=0,this.open=function(){if(L||N)return z.then((function(){return C?kt(C):V}));j&&(Y._stackHolder=K()),L=!0,C=null,H=!1;var t=u,n=null;return Ce.race([Y,new Ce((function(t,r){if(!b)throw new Z.MissingAPI("indexedDB API not found. If using IE10+, make sure to run your code on a server URL (not locally). If using old Safari versions, make sure to include indexedDB polyfill.");var i=J?b.open(e):b.open(e,Math.round(10*V.verno));if(!i)throw new Z.MissingAPI("IndexedDB API not available");i.onerror=Mt(r),i.onblocked=nt(Ge),i.onupgradeneeded=nt((function(t){if(n=i.transaction,J&&!V._allowEmptyDB){i.onerror=Gt,n.abort(),i.result.close();var o=b.deleteDatabase(e);o.onsuccess=o.onerror=nt((function(){r(new Z.NoSuchDatabase("Database "+e+" doesnt exist"))}))}else{n.onerror=Mt(r);var u=t.oldVersion>Math.pow(2,62)?0:t.oldVersion;ne(u/10,n,r,i)}}),r),i.onsuccess=nt((function(){if(n=null,N=i.result,St.push(V),J)We();else if(N.objectStoreNames.length>0)try{He(O,N.transaction(Yt(N.objectStoreNames),G))}catch(r){}N.onversionchange=nt((function(e){V._vcFired=!0,V.on("versionchange").fire(e)})),$||"__dbnames"===e||Ut.dbnames.put({name:e}).catch(re),t()}),r)}))]).then((function(){return M=[],Ce.resolve(Nt.vip(V.on.ready.fire)).then((function e(){if(M.length>0){var t=M.reduce(fe,re);return M=[],Ce.resolve(Nt.vip(t)).then(e)}}))})).finally((function(){M=null})).then((function(){return L=!1,V})).catch((function(e){try{n&&n.abort()}catch(t){}return L=!1,V.close(),C=e,kt(C)})).finally((function(){H=!0,t()}))},this.close=function(){var e=St.indexOf(V);if(e>=0&&St.splice(e,1),N){try{N.close()}catch(t){}N=null}p=!1,C=new Z.DatabaseClosed,L&&a(C),z=new Ce((function(e){u=e})),Y=new Ce((function(e,t){a=t}))},this.delete=function(){var t=arguments.length>0;return new Ce((function(n,r){if(t)throw new Z.InvalidArgument("Arguments not allowed in db.delete()");function i(){V.close();var t=b.deleteDatabase(e);t.onsuccess=nt((function(){$||Ut.dbnames.delete(e).catch(re),n()})),t.onerror=Mt(r),t.onblocked=Ge}L?z.then(i):i()}))},this.backendDB=function(){return N},this.isOpen=function(){return null!==N},this.hasBeenClosed=function(){return C&&C instanceof Z.DatabaseClosed},this.hasFailed=function(){return null!==C},this.dynamicallyOpened=function(){return J},this.name=e,s(this,{tables:{get:function(){return n(T).map((function(e){return T[e]}))}}}),this.on=Et(this,"populate","blocked","versionchange",{ready:[fe,re]}),this.on.ready.subscribe=m(this.on.ready.subscribe,(function(e){return function(t,n){Nt.vip((function(){H?(C||Ce.resolve().then(t),n&&e(t)):M?(M.push(t),n&&e(t)):(e(t),n||e((function e(){V.on.ready.unsubscribe(t),V.on.ready.unsubscribe(e)})))}))}})),this.transaction=function(){var e=me.apply(this,arguments);return this._transaction.apply(this,e)},this._transaction=function(e,t,n){var r=Re.trans;r&&r.db===V&&-1===e.indexOf("!")||(r=null);var i=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{var o=t.map((function(e){var t=e instanceof ge?e.name:e;if("string"!==typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t}));if("r"==e||e==G)e=G;else{if("rw"!=e&&e!=q)throw new Z.InvalidArgument("Invalid transaction mode: "+e);e=q}if(r){if(r.mode===G&&e===q){if(!i)throw new Z.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");r=null}r&&o.forEach((function(e){if(r&&-1===r.storeNames.indexOf(e)){if(!i)throw new Z.SubTransaction("Table "+e+" not included in parent transaction.");r=null}})),i&&r&&!r.active&&(r=null)}}catch(a){return r?r._promise(null,(function(e,t){t(a)})):kt(a)}return r?r._promise(e,u,"lock"):Re.trans?mt(Re.transless,(function(){return V._whenReady(u)})):V._whenReady(u);function u(){return Ce.resolve().then((function(){var t,i=Re.transless||Re,u=V._createTransaction(e,o,O,r),a={trans:u,transless:i};r?u.idbtrans=r.idbtrans:u.create(),n.constructor===we&&lt();var c=Ce.follow((function(){if(t=n.call(u,u),t)if(t.constructor===Fe){var e=ft.bind(null,null);t.then(e,e)}else"function"===typeof t.next&&"function"===typeof t.throw&&(t=qt(t))}),a);return(t&&"function"===typeof t.then?Ce.resolve(t).then((function(e){return u.active?e:kt(new Z.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):c.then((function(){return t}))).then((function(e){return r&&u._resolve(),u._completion.then((function(){return e}))})).catch((function(e){return u._reject(e),kt(e)}))}))}},this.table=function(e){if(!c(T,e))throw new Z.InvalidTable("Table "+e+" does not exist");return T[e]},s(ge.prototype,{_trans:function(e,t,n){var r=this._tx||Re.trans;return r&&r.db===V?r===Re.trans?r._promise(e,t,n):st((function(){return r._promise(e,t,n)}),{trans:r,transless:Re.transless||Re}):ye(e,[this.name],t)},_idbstore:function(e,t,n){var r=this.name;function i(e,n,i){if(-1===i.storeNames.indexOf(r))throw new Z.NotFound("Table"+r+" not part of transaction");return t(e,n,i.idbtrans.objectStore(r),i)}return this._trans(e,i,n)},get:function(e,t){if(e&&e.constructor===Object)return this.where(e).first(t);var n=this;return this._idbstore(G,(function(t,r,i){var o=i.get(e);o.onerror=Mt(r),o.onsuccess=nt((function(){t(n.hook.reading.fire(o.result))}),r)})).then(t)},where:function(e){if("string"===typeof e)return new Ee(this,e);if(r(e))return new Ee(this,"["+e.join("+")+"]");var t=n(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var i=this.schema.indexes.concat(this.schema.primKey).filter((function(e){return e.compound&&t.every((function(t){return e.keyPath.indexOf(t)>=0}))&&e.keyPath.every((function(e){return t.indexOf(e)>=0}))}))[0];if(i&&At!==Ot)return this.where(i.name).equals(i.keyPath.map((function(t){return e[t]})));i||console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a compound index ["+t.join("+")+"]");var o=this.schema.idxByName,u=t.reduce((function(t,n){return[t[0]||o[n],t[0]||!o[n]?Me(t[1],(function(t){return""+k(t,n)==""+e[n]})):t[1]]}),[null,null]),a=u[0];return a?this.where(a.name).equals(e[a.keyPath]).filter(u[1]):i?this.filter(u[1]):this.where(t).equals("")},count:function(e){return this.toCollection().count(e)},offset:function(e){return this.toCollection().offset(e)},limit:function(e){return this.toCollection().limit(e)},reverse:function(){return this.toCollection().reverse()},filter:function(e){return this.toCollection().and(e)},each:function(e){return this.toCollection().each(e)},toArray:function(e){return this.toCollection().toArray(e)},orderBy:function(e){return new Ue(new Ee(this,r(e)?"["+e.join("+")+"]":e))},toCollection:function(){return new Ue(new Ee(this))},mapToClass:function(e,t){this.schema.mappedClass=e;var n=Object.create(e.prototype);t&&Lt(n,t),this.schema.instanceTemplate=n;var r=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(c(t,r))try{n[r]=t[r]}catch(i){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=r,this.hook("reading",r),e},defineClass:function(e){return this.mapToClass(Nt.defineClass(e),e)},bulkDelete:function(e){return this.hook.deleting.fire===re?this._idbstore(q,(function(t,n,r,i){t(_e(r,i,e,!1,re))})):this.where(":id").anyOf(e).delete().then((function(){}))},bulkPut:function(e,t){var n=this;return this._idbstore(q,(function(r,i,o){if(!o.keyPath&&!n.schema.primKey.auto&&!t)throw new Z.InvalidArgument("bulkPut() with non-inbound keys requires keys array in second argument");if(o.keyPath&&t)throw new Z.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(t&&t.length!==e.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");if(0===e.length)return r();var u,a,c=function(e){0===s.length?r(e):i(new X(n.name+".bulkPut(): "+s.length+" of "+l+" operations failed",s))},s=[],l=e.length,f=n;if(n.hook.creating.fire===re&&n.hook.updating.fire===re){a=be(s);for(var h=0,d=e.length;h<d;++h)u=t?o.put(e[h],t[h]):o.put(e[h]),u.onerror=a;u.onerror=be(s,c),u.onsuccess=Wt(c)}else{var v=t||o.keyPath&&e.map((function(e){return k(e,o.keyPath)})),p=v&&_(v,(function(t,n){return null!=t&&[t,e[n]]})),y=v?f.where(":id").anyOf(v.filter((function(e){return null!=e}))).modify((function(){this.value=p[this.primKey],p[this.primKey]=null})).catch(Q,(function(e){s=e.failures})).then((function(){for(var n=[],r=t&&[],i=v.length-1;i>=0;--i){var o=v[i];(null==o||p[o])&&(n.push(e[i]),t&&r.push(o),null!=o&&(p[o]=null))}return n.reverse(),t&&r.reverse(),f.bulkAdd(n,r)})).then((function(e){var t=v[v.length-1];return null!=t?t:e})):f.bulkAdd(e);y.then(c).catch(X,(function(e){s=s.concat(e.failures),c()})).catch(i)}}),"locked")},bulkAdd:function(e,t){var n=this,r=this.hook.creating.fire;return this._idbstore(q,(function(i,o,u,a){if(!u.keyPath&&!n.schema.primKey.auto&&!t)throw new Z.InvalidArgument("bulkAdd() with non-inbound keys requires keys array in second argument");if(u.keyPath&&t)throw new Z.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(t&&t.length!==e.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");if(0===e.length)return i();function c(e){0===h.length?i(e):o(new X(n.name+".bulkAdd(): "+h.length+" of "+d+" operations failed",h))}var s,l,f,h=[],d=e.length;if(r!==re){var v,p=u.keyPath;l=be(h,null,!0),f=Kt(null),w((function(){for(var n=0,i=e.length;n<i;++n){v={onerror:null,onsuccess:null};var o=t&&t[n],c=e[n],h=t?o:p?k(c,p):void 0,d=r.call(v,h,c,a);null==h&&null!=d&&(p?(c=x(c),E(c,p,d)):o=d),s=null!=o?u.add(c,o):u.add(c),s._hookCtx=v,n<i-1&&(s.onerror=l,v.onsuccess&&(s.onsuccess=f))}}),(function(e){throw v.onerror&&v.onerror(e),e})),s.onerror=be(h,c,!0),s.onsuccess=Kt(c)}else{l=be(h);for(var y=0,m=e.length;y<m;++y)s=t?u.add(e[y],t[y]):u.add(e[y]),s.onerror=l;s.onerror=be(h,c),s.onsuccess=Wt(c)}}))},add:function(e,t){var n=this.hook.creating.fire;return this._idbstore(q,(function(r,i,o,u){var a={onsuccess:null,onerror:null};if(n!==re){var c=null!=t?t:o.keyPath?k(e,o.keyPath):void 0,s=n.call(a,c,e,u);null==c&&null!=s&&(o.keyPath?E(e,o.keyPath,s):t=s)}try{var l=null!=t?o.add(e,t):o.add(e);l._hookCtx=a,l.onerror=Ht(i),l.onsuccess=Kt((function(t){var n=o.keyPath;n&&E(e,n,t),r(t)}))}catch(f){throw a.onerror&&a.onerror(f),f}}))},put:function(e,t){var n=this,r=this.hook.creating.fire,i=this.hook.updating.fire;if(r!==re||i!==re){var o=this.schema.primKey.keyPath,u=void 0!==t?t:o&&k(e,o);return null==u?this.add(e):(e=x(e),this._trans(q,(function(){return n.where(":id").equals(u).modify((function(){this.value=e})).then((function(r){return 0===r?n.add(e,t):u}))}),"locked"))}return this._idbstore(q,(function(n,r,i){var o=void 0!==t?i.put(e,t):i.put(e);o.onerror=Mt(r),o.onsuccess=nt((function(t){var r=i.keyPath;r&&E(e,r,t.target.result),n(o.result)}))}))},delete:function(e){return this.hook.deleting.subscribers.length?this.where(":id").equals(e).delete():this._idbstore(q,(function(t,n,r){var i=r.delete(e);i.onerror=Mt(n),i.onsuccess=nt((function(){t(i.result)}))}))},clear:function(){return this.hook.deleting.subscribers.length?this.toCollection().delete():this._idbstore(q,(function(e,t,n){var r=n.clear();r.onerror=Mt(t),r.onsuccess=nt((function(){e(r.result)}))}))},update:function(e,t){if("object"!==typeof t||r(t))throw new Z.InvalidArgument("Modifications must be an object.");if("object"!==typeof e||r(e))return this.where(":id").equals(e).modify(t);n(t).forEach((function(n){E(e,n,t[n])}));var i=k(e,this.schema.primKey.keyPath);return void 0===i?kt(new Z.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(i).modify(t)}}),s(ke.prototype,{_lock:function(){return g(!Re.global),++this._reculock,1!==this._reculock||Re.global||(Re.lockOwnerFor=this),this},_unlock:function(){if(g(!Re.global),0===--this._reculock){Re.global||(Re.lockOwnerFor=null);while(this._blockedFuncs.length>0&&!this._locked()){var e=this._blockedFuncs.shift();try{mt(e[1],e[0])}catch(t){}}}return this},_locked:function(){return this._reculock&&Re.lockOwnerFor!==this},create:function(e){var t=this;if(!this.mode)return this;if(g(!this.idbtrans),!e&&!N)switch(C&&C.name){case"DatabaseClosedError":throw new Z.DatabaseClosed(C);case"MissingAPIError":throw new Z.MissingAPI(C.message,C);default:throw new Z.OpenFailed(C)}if(!this.active)throw new Z.TransactionInactive;return g(null===this._completion._state),e=this.idbtrans=e||N.transaction(Yt(this.storeNames),this.mode),e.onerror=nt((function(n){Gt(n),t._reject(e.error)})),e.onabort=nt((function(n){Gt(n),t.active&&t._reject(new Z.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=nt((function(){t.active=!1,t._resolve()})),this},_promise:function(e,t,n){var r=this;if(e===q&&this.mode!==q)return kt(new Z.ReadOnly("Transaction is readonly"));if(!this.active)return kt(new Z.TransactionInactive);if(this._locked())return new Ce((function(i,o){r._blockedFuncs.push([function(){r._promise(e,t,n).then(i,o)},Re])}));if(n)return st((function(){var e=new Ce((function(e,n){r._lock();var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var i=new Ce((function(e,n){var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return i._lib=!0,i},_root:function(){return this.parent?this.parent._root():this},waitFor:function(e){var t=this._root();if(e=Ce.resolve(e),t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return e}));else{t._waitingFor=e,t._waitingQueue=[];var n=t.idbtrans.objectStore(t.storeNames[0]);(function e(){++t._spinCount;while(t._waitingQueue.length)t._waitingQueue.shift()();t._waitingFor&&(n.get(-1/0).onsuccess=e)})()}var r=t._waitingFor;return new Ce((function(n,i){e.then((function(e){return t._waitingQueue.push(nt(n.bind(null,e)))}),(function(e){return t._waitingQueue.push(nt(i.bind(null,e)))})).finally((function(){t._waitingFor===r&&(t._waitingFor=null)}))}))},abort:function(){this.active&&this._reject(new Z.Abort),this.active=!1},tables:{get:W("Transaction.tables",(function(){return T}))},table:function(e){var t=V.table(e);return new ge(e,t.schema,this)}}),s(Ee.prototype,(function(){function e(e,t,n){var r=e instanceof Ee?new Ue(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function t(e){return new Ue(e,(function(){return U.only("")})).limit(0)}function n(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function r(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function i(e,t,n,r,i,o){for(var u=Math.min(e.length,r.length),a=-1,c=0;c<u;++c){var s=t[c];if(s!==r[c])return i(e[c],n[c])<0?e.substr(0,c)+n[c]+n.substr(c+1):i(e[c],r[c])<0?e.substr(0,c)+r[c]+n.substr(c+1):a>=0?e.substr(0,a)+t[a]+n.substr(a+1):null;i(e[c],s)<0&&(a=c)}return u<r.length&&"next"===o?e+n.substr(e.length):u<e.length&&"prev"===o?e.substr(0,n.length):a<0?null:e.substr(0,a)+r[a]+n.substr(a+1)}function o(t,o,u,a){var c,s,l,f,h,d,v,p=u.length;if(!u.every((function(e){return"string"===typeof e})))return e(t,Pt);function y(e){c=n(e),s=r(e),l="next"===e?Le:Ke;var t=u.map((function(e){return{lower:s(e),upper:c(e)}})).sort((function(e,t){return l(e.lower,t.lower)}));f=t.map((function(e){return e.upper})),h=t.map((function(e){return e.lower})),d=e,v="next"===e?"":a}y("next");var m=new Ue(t,(function(){return U.bound(f[0],h[p-1]+a)}));m._ondirectionchange=function(e){y(e)};var g=0;return m._addAlgorithm((function(e,t,n){var r=e.key;if("string"!==typeof r)return!1;var u=s(r);if(o(u,h,g))return!0;for(var a=null,c=g;c<p;++c){var y=i(r,u,f[c],h[c],l,d);null===y&&null===a?g=c+1:(null===a||l(a,y)>0)&&(a=y)}return t(null!==a?function(){e.continue(a+v)}:n),!1})),m}return{between:function(n,r,i,o){i=!1!==i,o=!0===o;try{return Se(n,r)>0||0===Se(n,r)&&(i||o)&&(!i||!o)?t(this):new Ue(this,(function(){return U.bound(n,r,!i,!o)}))}catch(u){return e(this,xt)}},equals:function(e){return new Ue(this,(function(){return U.only(e)}))},above:function(e){return new Ue(this,(function(){return U.lowerBound(e,!0)}))},aboveOrEqual:function(e){return new Ue(this,(function(){return U.lowerBound(e)}))},below:function(e){return new Ue(this,(function(){return U.upperBound(e,!0)}))},belowOrEqual:function(e){return new Ue(this,(function(){return U.upperBound(e)}))},startsWith:function(t){return"string"!==typeof t?e(this,Pt):this.between(t,t+Ot,!0,!0)},startsWithIgnoreCase:function(e){return""===e?this.startsWith(e):o(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],Ot)},equalsIgnoreCase:function(e){return o(this,(function(e,t){return e===t[0]}),[e],"")},anyOfIgnoreCase:function(){var e=I.apply(R,arguments);return 0===e.length?t(this):o(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},startsWithAnyOfIgnoreCase:function(){var e=I.apply(R,arguments);return 0===e.length?t(this):o(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,Ot)},anyOf:function(){var n=I.apply(R,arguments),r=je;try{n.sort(r)}catch(u){return e(this,xt)}if(0===n.length)return t(this);var i=new Ue(this,(function(){return U.bound(n[0],n[n.length-1])}));i._ondirectionchange=function(e){r="next"===e?je:Ne,n.sort(r)};var o=0;return i._addAlgorithm((function(e,t,i){var u=e.key;while(r(u,n[o])>0)if(++o,o===n.length)return t(i),!1;return 0===r(u,n[o])||(t((function(){e.continue(n[o])})),!1)})),i},notEqual:function(e){return this.inAnyRange([[Dt,e],[e,At]],{includeLowers:!1,includeUppers:!1})},noneOf:function(){var t=I.apply(R,arguments);if(0===t.length)return new Ue(this);try{t.sort(je)}catch(r){return e(this,xt)}var n=t.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[Dt,t]]}),null);return n.push([t[t.length-1],At]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},inAnyRange:function(n,r){if(0===n.length)return t(this);if(!n.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&je(e[0],e[1])<=0})))return e(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Z.InvalidArgument);var i=!r||!1!==r.includeLowers,o=r&&!0===r.includeUppers;function u(e,t){for(var n=0,r=e.length;n<r;++n){var i=e[n];if(Se(t[0],i[1])<0&&Se(t[1],i[0])>0){i[0]=Te(i[0],t[0]),i[1]=Ie(i[1],t[1]);break}}return n===r&&e.push(t),e}var a,c=je;function s(e,t){return c(e[0],t[0])}try{a=n.reduce(u,[]),a.sort(s)}catch(y){return e(this,xt)}var l=0,f=o?function(e){return je(e,a[l][1])>0}:function(e){return je(e,a[l][1])>=0},h=i?function(e){return Ne(e,a[l][0])>0}:function(e){return Ne(e,a[l][0])>=0};function d(e){return!f(e)&&!h(e)}var v=f,p=new Ue(this,(function(){return U.bound(a[0][0],a[a.length-1][1],!i,!o)}));return p._ondirectionchange=function(e){"next"===e?(v=f,c=je):(v=h,c=Ne),a.sort(s)},p._addAlgorithm((function(e,t,n){var r=e.key;while(v(r))if(++l,l===a.length)return t(n),!1;return!!d(r)||(0===Se(r,a[l][1])||0===Se(r,a[l][0])||t((function(){c===je?e.continue(a[l][0]):e.continue(a[l][1])})),!1)})),p},startsWithAnyOf:function(){var n=I.apply(R,arguments);return n.every((function(e){return"string"===typeof e}))?0===n.length?t(this):this.inAnyRange(n.map((function(e){return[e,e+Ot]}))):e(this,"startsWithAnyOf() only works with strings")}}})),s(Ue.prototype,(function(){function e(e,t){e.filter=Me(e.filter,t)}function t(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Me(r(),t())}:t,e.justLimit=n&&!r}function r(e,t){e.isMatch=Me(e.isMatch,t)}function i(e,t){if(e.isPrimKey)return t;var n=e.table.schema.idxByName[e.index];if(!n)throw new Z.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return t.index(n.name)}function u(e,t){var n=i(e,t);return e.keysOnly&&"openKeyCursor"in n?n.openKeyCursor(e.range||null,e.dir+e.unique):n.openCursor(e.range||null,e.dir+e.unique)}function a(e,t,n,r,i){var o=e.replayFilter?Me(e.filter,e.replayFilter()):e.filter;e.or?function(){var a={},s=0;function l(){2===++s&&n()}function f(e,n,i){if(!o||o(n,i,l,r)){var u=n.primaryKey,s=""+u;"[object ArrayBuffer]"===s&&(s=""+new Uint8Array(u)),c(a,s)||(a[s]=!0,t(e,n,i))}}e.or._iterate(f,l,r,i),xe(u(e,i),e.algorithm,f,l,r,!e.keysOnly&&e.valueMapper)}():xe(u(e,i),Me(e.algorithm,o),t,n,r,!e.keysOnly&&e.valueMapper)}return{_read:function(e,t){var n=this._ctx;return n.error?n.table._trans(null,kt.bind(null,n.error)):n.table._idbstore(G,e).then(t)},_write:function(e){var t=this._ctx;return t.error?t.table._trans(null,kt.bind(null,t.error)):t.table._idbstore(q,e,"locked")},_addAlgorithm:function(e){var t=this._ctx;t.algorithm=Me(t.algorithm,e)},_iterate:function(e,t,n,r){return a(this._ctx,e,t,n,r)},clone:function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&o(n,e),t._ctx=n,t},raw:function(){return this._ctx.valueMapper=null,this},each:function(e){var t=this._ctx;return this._read((function(n,r,i){a(t,e,n,r,i)}))},count:function(e){var t=this._ctx;if(Be(t,!0))return this._read((function(e,n,r){var o=i(t,r),u=t.range?o.count(t.range):o.count();u.onerror=Mt(n),u.onsuccess=function(n){e(Math.min(n.target.result,t.limit))}}),e);var n=0;return this._read((function(e,r,i){a(t,(function(){return++n,!1}),(function(){e(n)}),r,i)}),e)},sortBy:function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var u="next"===this._ctx.dir?1:-1;function a(e,t){var n=o(e,i),r=o(t,i);return n<r?-u:n>r?u:0}return this.toArray((function(e){return e.sort(a)})).then(t)},toArray:function(e){var t=this._ctx;return this._read((function(e,n,r){if(l&&"next"===t.dir&&Be(t,!0)&&t.limit>0){var o=t.table.hook.reading.fire,u=i(t,r),c=t.limit<1/0?u.getAll(t.range,t.limit):u.getAll(t.range);c.onerror=Mt(n),c.onsuccess=Wt(o===ie?e:function(t){try{e(t.map(o))}catch(r){n(r)}})}else{var s=[];a(t,(function(e){s.push(e)}),(function(){e(s)}),n,r)}}),e)},offset:function(e){var n=this._ctx;return e<=0||(n.offset+=e,Be(n)?t(n,(function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n((function(){e.advance(t),t=0})),!1))}})):t(n,(function(){var t=e;return function(){return--t<0}}))),this},limit:function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),t(this._ctx,(function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this},until:function(t,n){return e(this._ctx,(function(e,r,i){return!t(e.value)||(r(i),n)})),this},first:function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},last:function(e){return this.reverse().first(e)},filter:function(t){return e(this._ctx,(function(e){return t(e.value)})),r(this._ctx,t),this},and:function(e){return this.filter(e)},or:function(e){return new Ee(this._ctx.table,e,this)},reverse:function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},desc:function(){return this.reverse()},eachKey:function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},eachUniqueKey:function(e){return this._ctx.unique="unique",this.eachKey(e)},eachPrimaryKey:function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},keys:function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},primaryKeys:function(e){var t=this._ctx;if(l&&"next"===t.dir&&Be(t,!0)&&t.limit>0)return this._read((function(e,n,r){var o=i(t,r),u=t.limit<1/0?o.getAllKeys(t.range,t.limit):o.getAllKeys(t.range);u.onerror=Mt(n),u.onsuccess=Wt(e)})).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)},uniqueKeys:function(e){return this._ctx.unique="unique",this.keys(e)},firstKey:function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},lastKey:function(e){return this.reverse().firstKey(e)},distinct:function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var r={};return e(this._ctx,(function(e){var t=e.primaryKey.toString(),n=c(r,t);return r[t]=!0,!n})),this},modify:function(e){var t=this,r=this._ctx,i=r.table.hook,u=i.updating.fire,a=i.deleting.fire;return this._write((function(r,i,s,l){var f;if("function"===typeof e)f=u===re&&a===re?e:function(t){var r=x(t);if(!1===e.call(this,t,this))return!1;if(c(this,"value")){var i=P(r,this.value),o=u.call(this,i,this.primKey,r,l);o&&(t=this.value,n(o).forEach((function(e){E(t,e,o[e])})))}else a.call(this,this.primKey,t,l)};else if(u===re){var h=n(e),d=h.length;f=function(t){for(var n=!1,r=0;r<d;++r){var i=h[r],o=e[i];k(t,i)!==o&&(E(t,i,o),n=!0)}return n}}else{var v=e;e=B(v),f=function(t){var r=!1,i=u.call(this,e,this.primKey,x(t),l);return i&&o(e,i),n(e).forEach((function(n){var i=e[n];k(t,n)!==i&&(E(t,n,i),r=!0)})),i&&(e=B(v)),r}}var p=0,y=0,m=!1,g=[],b=[],_=null;function F(e,t){_=t.primaryKey;var n={primKey:t.primaryKey,value:e,onsuccess:null,onerror:null};function r(e){return g.push(e),b.push(n.primKey),O(),!0}if(!1!==f.call(n,e,n)){var i=!c(n,"value");++p,w((function(){var e=i?t.delete():t.update(n.value);e._hookCtx=n,e.onerror=Ht(r),e.onsuccess=Kt((function(){++y,O()}))}),r)}else n.onsuccess&&n.onsuccess(n.value)}function U(e){return e&&(g.push(e),b.push(_)),i(new Q("Error modifying one or more objects",g,y,b))}function O(){m&&y+g.length===p&&(g.length>0?U():r(y))}t.clone().raw()._iterate(F,(function(){m=!0,O()}),U,s)}))},delete:function(){var e=this,t=this._ctx,n=t.range,r=t.table.hook.deleting.fire,i=r!==re;if(!i&&Be(t)&&(t.isPrimKey&&!It||!n))return this._write((function(e,t,r){var i=Mt(t),o=n?r.count(n):r.count();o.onerror=i,o.onsuccess=function(){var u=o.result;w((function(){var t=n?r.delete(n):r.clear();t.onerror=i,t.onsuccess=function(){return e(u)}}),(function(e){return t(e)}))}}));var o=i?2e3:1e4;return this._write((function(n,u,a,c){var s=0,l=e.clone({keysOnly:!t.isMatch&&!i}).distinct().limit(o).raw(),f=[],h=function(){return l.each(i?function(e,t){f.push([t.primaryKey,t.value])}:function(e,t){f.push(t.primaryKey)}).then((function(){return i?f.sort((function(e,t){return je(e[0],t[0])})):f.sort(je),_e(a,c,f,i,r)})).then((function(){var e=f.length;return s+=e,f=[],e<o?s:h()}))};n(h())}))}}})),o(this,{Collection:Ue,Table:ge,Transaction:ke,Version:te,WhereClause:Ee}),ee(),v.forEach((function(e){e(V)}))}function Ct(e){if("function"===typeof e)return new e;if(r(e))return[Ct(e[0])];if(e&&"object"===typeof e){var t={};return Lt(t,e),t}return e}function Lt(e,t){return n(t).forEach((function(n){var r=Ct(t[n]);e[n]=r})),e}function Kt(e){return nt((function(t){var n=t.target,r=n._hookCtx,i=r.value||n.result,o=r&&r.onsuccess;o&&o(i),e&&e(i)}),e)}function Mt(e){return nt((function(t){return Gt(t),e(t.target.error),!1}))}function Wt(e){return nt((function(t){e(t.target.result)}))}function Ht(e){return nt((function(t){var n=t.target,r=n.error,i=n._hookCtx,o=i&&i.onerror;return o&&o(r),Gt(t),e(r),!1}))}function Gt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}function qt(e){var t=function(t){return e.next(t)},n=function(t){return e.throw(t)},i=u(t),o=u(n);function u(e){return function(t){var n=e(t),u=n.value;return n.done?u:u&&"function"===typeof u.then?u.then(i,o):r(u)?Ce.all(u).then(i,o):i(u)}}return u(t)()}function Vt(e,t,n,r,i,o,u){this.name=e,this.keyPath=t,this.unique=n,this.multi=r,this.auto=i,this.compound=o,this.dotted=u;var a="string"===typeof t?t:t&&"["+[].join.call(t,"+")+"]";this.src=(n?"&":"")+(r?"*":"")+(i?"++":"")+a}function zt(e,t,n,r){this.name=e,this.primKey=t||new Vt,this.indexes=n||[new Vt],this.instanceTemplate=r,this.mappedClass=null,this.idxByName=_(n,(function(e){return[e.name,e]}))}function Yt(e){return 1===e.length?e[0]:e}function Qt(e){var t=e&&(e.getDatabaseNames||e.webkitGetDatabaseNames);return t&&t.bind(e)}N(j,jt),s(Nt,ne),s(Nt,{delete:function(e){var t=new Nt(e),n=t.delete();return n.onblocked=function(e){return t.on("blocked",e),this},n},exists:function(e){return new Nt(e).open().then((function(e){return e.close(),!0})).catch(Nt.NoSuchDatabaseError,(function(){return!1}))},getDatabaseNames:function(e){var t=Qt(Nt.dependencies.indexedDB);return t?new Ce((function(e,n){var r=t();r.onsuccess=function(t){e(y(t.target.result,0))},r.onerror=Mt(n)})).then(e):Ut.dbnames.toCollection().primaryKeys(e)},defineClass:function(){function e(e){e&&o(this,e)}return e},applyStructure:Lt,ignoreTransaction:function(e){return Re.trans?mt(Re.transless,e):e()},vip:function(e){return st((function(){return Re.letThrough=!0,e()}))},async:function(e){return function(){try{var t=qt(e.apply(this,arguments));return t&&"function"===typeof t.then?t:Ce.resolve(t)}catch(n){return kt(n)}}},spawn:function(e,t,n){try{var r=qt(e.apply(n,t||[]));return r&&"function"===typeof r.then?r:Ce.resolve(r)}catch(i){return kt(i)}},currentTransaction:{get:function(){return Re.trans||null}},waitFor:function(e,t){var n=Ce.resolve("function"===typeof e?Nt.ignoreTransaction(e):e).timeout(t||6e4);return Re.trans?Re.trans.waitFor(n):n},Promise:Ce,debug:{get:function(){return j},set:function(e){N(e,"dexie"===e?function(){return!0}:jt)}},derive:h,extend:o,props:s,override:m,Events:Et,getByKeyPath:k,setByKeyPath:E,delByKeyPath:U,shallowClone:B,deepClone:x,getObjectDiff:P,asap:b,maxKey:At,minKey:Dt,addons:[],connections:St,MultiModifyError:Z.Modify,errnames:J,IndexSpec:Vt,TableSchema:zt,dependencies:function(){try{return{indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch(e){return{indexedDB:null,IDBKeyRange:null}}}(),semVer:Bt,version:Bt.split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)})),default:Nt,Dexie:Nt}),Ce.rejectionMapper=te,Ut=new Nt("__dbnames"),Ut.version(1).stores({dbnames:"name"}),function(){var e="Dexie.DatabaseNames";try{void 0!==typeof localStorage&&void 0!==i.document&&(JSON.parse(localStorage.getItem(e)||"[]").forEach((function(e){return Ut.dbnames.put({name:e}).catch(re)})),localStorage.removeItem(e))}catch(t){}}(),t["a"]=Nt}).call(this,n("c8ba"))},"96cf":function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",a=i.toStringTag||"@@toStringTag";function c(e,t,n,r){var i=t&&t.prototype instanceof p?t:p,o=Object.create(i.prototype),u=new A(r||[]);return o._invoke=E(e,n,u),o}function s(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}e.wrap=c;var l="suspendedStart",f="suspendedYield",h="executing",d="completed",v={};function p(){}function y(){}function m(){}var g={};g[o]=function(){return this};var b=Object.getPrototypeOf,_=b&&b(b(D([])));_&&_!==n&&r.call(_,o)&&(g=_);var F=m.prototype=p.prototype=Object.create(g);function w(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function k(e,t){function n(i,o,u,a){var c=s(e[i],e,o);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"===typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,u,a)}),(function(e){n("throw",e,u,a)})):t.resolve(f).then((function(e){l.value=e,u(l)}),(function(e){return n("throw",e,u,a)}))}a(c.arg)}var i;function o(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}this._invoke=o}function E(e,t,n){var r=l;return function(i,o){if(r===h)throw new Error("Generator is already running");if(r===d){if("throw"===i)throw o;return x()}n.method=i,n.arg=o;while(1){var u=n.delegate;if(u){var a=U(u,n);if(a){if(a===v)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===l)throw r=d,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var c=s(e,t,n);if("normal"===c.type){if(r=n.done?d:f,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=d,n.method="throw",n.arg=c.arg)}}}function U(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator["return"]&&(n.method="return",n.arg=t,U(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=s(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function B(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(B,this),this.reset(!0)}function D(e){if(e){var n=e[o];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,u=function n(){while(++i<e.length)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return u.next=u}}return{next:x}}function x(){return{value:t,done:!0}}return y.prototype=F.constructor=m,m.constructor=y,m[a]=y.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(F),e},e.awrap=function(e){return{__await:e}},w(k.prototype),k.prototype[u]=function(){return this},e.AsyncIterator=k,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var u=new k(c(t,n,r,i),o);return e.isGeneratorFunction(n)?u:u.next().then((function(e){return e.done?e.value:u.next()}))},w(F),F[a]="Generator",F[o]=function(){return this},F.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){while(t.length){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=D,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(O),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var u=this.tryEntries[o],a=u.completion;if("root"===u.tryLoc)return i("end");if(u.tryLoc<=this.prev){var c=r.call(u,"catchLoc"),s=r.call(u,"finallyLoc");if(c&&s){if(this.prev<u.catchLoc)return i(u.catchLoc,!0);if(this.prev<u.finallyLoc)return i(u.finallyLoc)}else if(c){if(this.prev<u.catchLoc)return i(u.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return i(u.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var u=o?o.completion:{};return u.type=e,u.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(u)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;O(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:D(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=r}catch(i){Function("r","regeneratorRuntime = r")(r)}},a34a:function(e,t,n){e.exports=n("96cf")},a692:function(e,t,n){"use strict";function r(e){return!!e&&("object"===typeof e||"function"===typeof e)&&"function"===typeof e.then}function i(e){function t(e,t,n,r){function i(t){"function"!==typeof self.postMessage?e.ports[0].postMessage(t):self.postMessage(t)}n?("undefined"!==typeof console&&"error"in console&&console.error("Worker caught an error:",n),i([t,{message:n.message}])):i([t,null,r])}function n(e,t){try{return{res:e(t)}}catch(n){return{err:n}}}function i(e,i,o,u){var a=n(i,u);a.err?t(e,o,a.err):r(a.res)?a.res.then((function(n){t(e,o,null,n)}),(function(n){t(e,o,n)})):t(e,o,null,a.res)}function o(n){var r=n.data;if(Array.isArray(r)&&2===r.length){var o=r[0],u=r[1];"function"!==typeof e?t(n,o,new Error("Please pass a function into register().")):i(n,e,o,u)}}self.addEventListener("message",o)}e.exports=i},c8ba:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}e.exports=n},faa7:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"units",(function(){return Ue})),n.d(r,"items",(function(){return Be})),n.d(r,"bursts",(function(){return Oe})),n.d(r,"extraSkills",(function(){return Ae})),n.d(r,"leaderSkills",(function(){return De})),n.d(r,"missions",(function(){return xe})),n.d(r,"dictionary",(function(){return Pe}));var i={};n.r(i),n.d(i,"units",(function(){return Ie})),n.d(i,"items",(function(){return je})),n.d(i,"bursts",(function(){return Ne})),n.d(i,"extraSkills",(function(){return Ce})),n.d(i,"leaderSkills",(function(){return Le})),n.d(i,"missions",(function(){return Ke})),n.d(i,"dictionary",(function(){return Me}));var o=n("a34a"),u=n.n(o),a=n("a692"),c=n.n(a);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}var h=function(){function e(){s(this,e),this._commands={}}return f(e,[{key:"request",value:function(t,n){return e._defer("request")}},{key:"onRequest",value:function(t,n){return e._defer("onRequest")}},{key:"registerCommand",value:function(e,t){arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("function"!==typeof t)throw new Error("Input is not a function");this._commands[e]=t}},{key:"unregisterCommand",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._commands.hasOwnProperty(e)&&delete this._commands[e]}},{key:"_classMethods",get:function(){var e=[],t=this,n=function(e){return"constructor"!==e&&!e.startsWith("_")},r=function(e,t){return(Object.getOwnPropertyDescriptor(e,t)||{}).get},i=function(e,t){return"function"===typeof e[t]};do{var o=Object.getOwnPropertyNames(t).filter((function(e){return n(e)&&(r(t,e)||i(t,e))}));e=e.concat(o)}while((t=Object.getPrototypeOf(t))&&t!==Object.prototype);return Array.from(new Set(e))}}],[{key:"_defer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"name of method to be deferred";return Promise.reject(new Error("Must implement ".concat(e,"() in subclass")))}}]),e}();function d(e){return d="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function v(e,t,n,r,i,o,u){try{var a=e[o](u),c=a.value}catch(s){return void n(s)}a.done?t(c):Promise.resolve(c).then(r,i)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function u(e){v(o,r,i,u,a,"next",e)}function a(e){v(o,r,i,u,a,"throw",e)}u(void 0)}))}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(e,t,n){return t&&m(e.prototype,t),n&&m(e,n),e}function b(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}function _(e,t){return _=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},_(e,t)}function F(e){return function(){var t,n=U(e);if(E()){var r=U(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return w(this,t)}}function w(e,t){return!t||"object"!==d(t)&&"function"!==typeof t?k(e):t}function k(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function U(e){return U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},U(e)}var B=function(e){b(n,e);var t=F(n);function n(){var e;return y(this,n),e=t.call(this),c()((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.command,r=t.data;return e.onRequest(n,r)})),e._cachedMethods=e._classMethods,e}return g(n,[{key:"onRequest",value:function(){var e=p(u.a.mark((function e(){var t,n,r,i=this,o=arguments;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]?o[0]:"",n=o.length>1?o[1]:void 0,!this._commands.hasOwnProperty(t)){e.next=8;break}return e.next=5,Promise.resolve().then((function(){return i._commands[t](n)}));case 5:r=e.sent,e.next=15;break;case 8:if(!this._cachedMethods.includes(t)){e.next=14;break}return e.next=11,Promise.resolve().then((function(){return i[t](n)}));case 11:r=e.sent,e.next=15;break;case 14:r=Promise.reject(new Error("Unknown command/method name [".concat(t,"]")));case 15:return e.abrupt("return",r);case 16:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"request",value:function(e,t){self.postMessage({command:e,data:t})}}]),n}(h),O=n("74ce");function A(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e,t,n){return t&&D(e.prototype,t),n&&D(e,n),e}var P=function(){function e(){A(this,e)}return x(e,[{key:"put",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.table,t.entry;return e._defer("put")}},{key:"get",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.table,t.query;return e._defer("get")}},{key:"delete",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.table,t.key;return e._defer("delete")}},{key:"getAll",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.table;return e._defer("getAll")}},{key:"getFieldInEntry",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.table,t.query,t.field;return e._defer("getFieldInEntry")}},{key:"getFieldKeys",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.table,t.query,t.field;return e._defer("getFieldKeys")}},{key:"getByIds",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.table,t.query,t.field,t.ids,t.extractedFields;return e._defer("getByIds")}},{key:"getById",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.table,t.query,t.field,t.id;return e._defer("getById")}},{key:"getDbStats",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.table,t.query;return e._defer("getDbStats")}},{key:"getTablesWithEntries",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.tables,t.query;return e._defer("getTablesWithEntries")}},{key:"getTablesWithUpdates",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.tables,t.query,t.sourceUrl,t.forceRefresh;return e._defer("getTablesWithUpdates")}},{key:"getFilteredDb",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.table,t.filters,t.server,t.extractedFields,t.sortOptions;return e._defer("getFilteredDb")}},{key:"getSortedKeys",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.table,t.sortOptions,t.server,t.keys;return e._defer("getSortedKeys")}}],[{key:"_defer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"name of method to be deferred";return Promise.reject(new Error("Must implement ".concat(e,"() in subclass")))}}]),e}();function S(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t,n){return t&&T(e.prototype,t),n&&T(e,n),e}var I=function(){function e(t){var n=t.prefix,r=void 0===n?"":n;S(this,e),this.prefix=r}return R(e,[{key:"assert",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];(e=console).assert.apply(e,[t,this.prefix].concat(r))}},{key:"debug",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).debug.apply(e,[this.prefix,"debug:".toUpperCase()].concat(n))}},{key:"error",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).error.apply(e,[this.prefix,"error:".toUpperCase()].concat(n))}},{key:"info",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).info.apply(e,[this.prefix,"info:".toUpperCase()].concat(n))}},{key:"log",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).log.apply(e,[this.prefix,"log:".toUpperCase()].concat(n))}},{key:"warn",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).warn.apply(e,[this.prefix,"warn:".toUpperCase()].concat(n))}},{key:"todo",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).warn.apply(e,[this.prefix,"todo:".toUpperCase()].concat(n))}}]),e}(),j=new I({prefix:"[APP]"}),N=new I({prefix:"[DB-WORKER]"});function C(e,t){return H(e)||W(e,t)||K(e,t)||L()}function L(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function K(e,t){if(e){if("string"===typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function W(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done);r=!0)if(n.push(u.value),t&&n.length===t)break}catch(c){i=!0,o=c}finally{try{r||null==a["return"]||a["return"]()}finally{if(i)throw o}}return n}}function H(e){if(Array.isArray(e))return e}function G(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V(e,t,n){return t&&q(e.prototype,t),n&&q(e,n),e}var z=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Option A",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Option B";G(this,e),j.assert(t!==n,"truthy and falsy values are equivalent",{truthyValue:t,falsyValue:n}),this._truthyValue=t.slice(),this._falsyValue=n.slice()}return V(e,[{key:"isAll",value:function(e){try{var t=e.split(","),n=C(t,2),r=n[0],i=n[1];return r===this._truthyValue&&i===this._falsyValue}catch(o){return!1}}},{key:"isTruthy",value:function(e){return this._truthyValue===e}},{key:"isFalsy",value:function(e){return this._falsyValue===e}},{key:"truthyValue",get:function(){return this._truthyValue.slice()}},{key:"falsyValue",get:function(){return this._falsyValue.slice()}},{key:"allValue",get:function(){return[this._truthyValue,this._falsyValue].join(",")}},{key:"valuesArray",get:function(){return[this.allValue,this.truthyValue,this.falsyValue]}},{key:"values",get:function(){return{all:this.allValue,truthy:this.truthyValue,falsy:this.falsyValue}}}]),e}(),Y=Object.freeze([{name:"units",fullName:"Units",type:"multidex",link:"/multidex/units"},{name:"items",fullName:"Items",type:"multidex",link:"/multidex/items"},{name:"bursts",fullName:"Bursts",type:"multidex",link:"/multidex/bursts"},{name:"extraSkills",fullName:"Extra Skills",type:"multidex",link:"/multidex/extra-skills"},{name:"leaderSkills",fullName:"Leader Skills",type:"multidex",link:"/multidex/leader-skills"},{name:"missions",fullName:"Missions",type:"multidex",link:"/multidex/missions"},{name:"dictionary",fullName:"Dictionary",type:"multidex",link:"/multidex/dictionary"}]),Q=(Object.freeze(["gl","eu","jp"]),Object.freeze(["fire","water","earth","thunder","light","dark"])),X=Object.freeze(["male","female","other"]),J=Object.freeze(["normal","evolution","enhancing","sale"]),$=Object.freeze(["consumable","material","raid","sphere","evomat","summoner_consumable","ls_sphere"]),Z=Object.freeze(["land","area","dungeon"]),ee=new z("with","without"),te=(new z("exclusive","non-exclusive"),new z("craftable","non-craftable")),ne=new z("used","unused"),re=(Object.freeze({consumable:"Item",material:"Material",sphere:"Sphere",evomat:"Evo Material",summoner_consumable:"Booster",raid:"Raid Item",ls_sphere:"LS Sphere"}),Object.freeze({0:"None",1:"Status Enhancing",2:"Critical",3:"Drop",4:"Ailment Inducing",5:"Element Fusion",6:"BB Gauge",7:"HP Recovery",8:"Target Setting",9:"Damage Deflecting",10:"Damage Reducing",11:"Spark",12:"Defense Piercing",13:"Attack Boosting",14:"Special"})),ie=Object.freeze({ATK:"atk",BB:"bb",SBB:"sbb",UBB:"ubb",NONE:"none"}),oe=(Object.freeze({aoe:"AOE",single:"ST",random:"RT"}),Object.freeze([ie.BB,ie.SBB,ie.UBB])),ue=Object.freeze(["ls","es","sp"].concat(oe)),ae=(Object.freeze(["lord","anima","breaker","guardian","oracle"]),Object.freeze(["poison","weak","sick","injury","curse","paralysis"])),ce=(Object.freeze(["hc","bc","item","zel","karma"]),Object.freeze(["hp","atk","def","rec"]),Object.freeze({1:"Moving",2:"Teleporting",3:"Non-Moving"}),Object.freeze({Moving:1,Teleporting:2,"Non-Moving":3}),Object.freeze({1:"Parameter Boost",2:"Spark",3:"Critical Hits",4:"Attack Boost",5:"BB Gauge",6:"HP Recovery",7:"Drops",8:"Ailment Resistance",9:"Ailment Infliction",10:"Damage Reduction",11:"Special"}),Object.freeze({mimic:"60142",batMimic:"60143",dragonMimic:"60144",metalMimic:"60224"}));Object.freeze({1e3:ce.mimic,1100:ce.batMimic,1101:ce.batMimic,1200:ce.dragonMimic,1300:ce.metalMimic}),Object.freeze(["Top Left","Top Right","Middle Left","Middle Right","Bottom Left","Bottom Right"]),Object.freeze({EMPTY:"(Empty)",ANY:"(Any)"}),Object.freeze({ATTACK:{name:"Attack",desc:"These types of effects directly inflict damage on targets."},PASSIVE:{name:"Passive",desc:"These effects are always active unless nullified by an enemy skill or battle restriction. Passives from different sources usually stack."},"INSTANT/BURST":{name:"Instant/Burst",desc:"These take effect as soon as they are cast and are usually stackable with other effects of the same type."},TIMED:{name:"Timed",desc:"These conditionally occur (e.g. from the start of battle, after X damage is taken, etc.) and last for a set amount of turns. Timed buffs of the same effect do not stack, regardless of the source. Newer timed buffs of the same type will override the old buff."},ACTIVE:{name:"Active",desc:"These are usually turn based; the source for these effects are from unit bursts (BB, SBB, UBB) or enemy skills. Newer active buffs of the same type will override the old buff (using the new value and duration)."},PERMANENT:{name:"Permanent",desc:"These remain in effect for the entire battle. Depending on the buff, it may go away once used."},UNKNOWN:{name:"Unknown",desc:"These effects aren't fully understood yet."},UNTRANSLATED:{name:"Untranslated",desc:"These effects aren't supported by the effect processor yet."}}),Object.freeze(["BUFF_ATKUP","BUFF_ATKDOWN","BUFF_DEFUP","BUFF_DEFDOWN","BUFF_RECUP","BUFF_RECDOWN","BUFF_CRTRATEUP","BUFF_HPREC","BUFF_HCDROP","BUFF_BCDROP","BUFF_ITEMDROP","BUFF_KOBLK","BUFF_FIREATKUP","BUFF_FIREDEFUP","BUFF_FIRERECUP","BUFF_WATERATKUP","BUFF_WATERDEFUP","BUFF_WATERRECUP","BUFF_EARTHATKUP","BUFF_EARTHDEFUP","BUFF_EARTHRECUP","BUFF_THUNDERATKUP","BUFF_THUNDERDEFUP","BUFF_THUNDERRECUP","BUFF_LIGHTATKUP","BUFF_LIGHTDEFUP","BUFF_LIGHTRECUP","BUFF_DARKATKUP","BUFF_DARKDEFUP","BUFF_DARKRECUP","BUFF_FIREATKDOWN","BUFF_FIREDEFDOWN","BUFF_FIRERECDOWN","BUFF_WATERATKDOWN","BUFF_WATERDEFDOWN","BUFF_WATERRECDOWN","BUFF_EARTHATKDOWN","BUFF_EARTHDEFDOWN","BUFF_EARTHRECDOWN","BUFF_THUNDERATKDOWN","BUFF_THUNDERDEFDOWN","BUFF_THUNDERRECDOWN","BUFF_LIGHTATKDOWN","BUFF_LIGHTDEFDOWN","BUFF_LIGHTRECDOWN","BUFF_DARKATKDOWN","BUFF_DARKDEFDOWN","BUFF_DARKRECDOWN","BUFF_FIREDMGDOWN","BUFF_WATERDMGDOWN","BUFF_EARTHDMGDOWN","BUFF_THUNDERDMGDOWN","BUFF_LIGHTDMGDOWN","BUFF_DARKDMGDOWN","BUFF_POISONBLK","BUFF_WEAKBLK","BUFF_SICKBLK","BUFF_INJURYBLK","BUFF_CURSEBLK","BUFF_PARALYSISBLK","BUFF_BBREC","BUFF_DAMAGEBB","BUFF_GETENEATT","BUFF_REPENEATT","BUFF_IGNOREDEF","BUFF_DBLSTRIKE","BUFF_HITUP","BUFF_ADDFIRE","BUFF_ADDWATER","BUFF_ADDEARTH","BUFF_ADDTHUNDER","BUFF_ADDLIGHT","BUFF_ADDDARK","BUFF_DAMAGECUT","BUFF_SPARKUP","BUFF_SPARKHC","BUFF_SPARKBC","BUFF_SPARKITEM","BUFF_DISABLELS","BUFF_RAIDATKUP","BUFF_RAIDDEFUP","BUFF_RAIDRECUP","BUFF_RAIDCRTUP","BUFF_RAIDDMGDOWN","BUFF_ATKDOWNLOCK","BUFF_DEFDOWNLOCK","BUFF_RECDOWNLOCK","BUFF_ADDPOISON","BUFF_ADDWEAK","BUFF_ADDSICK","BUFF_ADDINJURY","BUFF_ADDCURSE","BUFF_ADDPARA","BUFF_SPARKABILITY","BUFF_ACTIVEOD","BUFF_TURNDMG","BUFF_BBATKUP","BUFF_COUNTERDAMAGE","BUFF_ADDATKDOWN","BUFF_ADDDEFDOWN","BUFF_ADDRECDOWN","BUFF_BBFILL","BUFF_CRTUP","BUFF_FIREDMGUP","BUFF_WATERMDGUP","BUFF_EARTHDMGUP","BUFF_THUNDERDMGUP","BUFF_LIGHTDMGUP","BUFF_DARKDMGUP","BUFF_POISIONCOUNTER","BUFF_WEAKCOUNTER","BUFF_SICKCOUNTER","BUFF_INJCONTER","BUFF_CURSECOUNTER","BUFF_PARALYCOUNTER","BUFF_KOBLOCK","BUFF_HCDOWN","BUFF_BCDOWN","BUFF_SPARKDMGUP","BUFF_BBATKDOWN","BUFF_FIRESHIELD","BUFF_WATERSHIELD","BUFF_EARTHSHIELD","BUFF_THUNDERSHIELD","BUFF_LIGHTSHIELD","BUFF_DARKSHIELD","BUFF_AILDMGUP","BUFF_SPARKBBUP","BUFF_GUARDCUT","BUFF_GUARDBBUP","BUFF_GUARDPARAMUP","BUFF_BBFILLDOWN","BUFF_SPARKATKUP","BUFF_SPARKDEFUP","BUFF_SPARKRECUP","BUFF_SPARKCRTUP","BUFF_RESISTATKDOWN","BUFF_RESISTDEFDOWN","BUFF_RESISTRECDOWN","BUFF_ATKUP2","BUFF_DEFUP2","BUFF_RECUP2","BUFF_SPARKCRTACTIVATED","BUFF_OVERDRIVEUP","BUFF_BEENATK_HPREC","BUFF_HPABS","BUFF_SPARK_HPREC","BUFF_ATKUP3","BUFF_DEFUP3","BUFF_RECUP3","BUFF_CRTRATEUP2","BUFF_SPARKDMGUP2","BUFF_HPREC2","BUFF_BBFILL2","BUFF_ATKUP4","BUFF_DEFUP4","BUFF_RECUP4","BUFF_CRTDOWN","BUFF_ELEMENTDOWN","BUFF_SPARKDMGDOWN","BUFF_AOEATK","BUFF_NULLSPHERE","BUFF_NULLES","BUFF_BBREDUC","BUFF_ODFILLBOOST","BUFF_ATKREDUC","BUFF_TARGETED","BUFF_PROB_ATKREDUC","BUFF_PROB_DEFREDUC","BUFF_PROB_RECREDUC","BUFF_CRITDMG_VUL","BUFF_ELEDMG_VUL","BUFF_NULLITEM","BUFF_NULLSWAP","BUFF_FIRESHIELDDOWN","BUFF_WATERSHIELDDOWN","BUFF_EARTHSHIELDDOWN","BUFF_THUNDERSHIELDDOWN","BUFF_LIGHTSHIELDDOWN","BUFF_DARKSHIELDDOWN"]),Object.freeze(["SG_BUFF_TAUNT","SG_BUFF_STEALTH","SG_BUFF_ALL","SG_BUFF_FIRE","SG_BUFF_WATER","SG_BUFF_EARTH","SG_BUFF_THUNDER","SG_BUFF_LIGHT","SG_BUFF_DARK","SG_BUFF_SPHERE_DISABLE","SG_BUFF_DMG_IMMUNINTY","SG_BUFF_SKIP_TURN","SG_BUFF_TIME_STOP","SG_BUFF_EVASION","SG_BUFF_CRTRATEDOWN","SG_BUFF_FIRESHIELDDOWN","SG_BUFF_WATERSHIELDDOWN","SG_BUFF_EARTHSHIELDDOWN","SG_BUFF_THUNDERSHIELDDOWN","SG_BUFF_LIGHTSHIELDDOWN","SG_BUFF_DARKSHIELDDOWN","SG_BUFF_WEAKSHIELD","SG_BUFF_DAMAGECUTDOWN","SG_BUFF_ATK_EU","SG_BUFF_DBLBB_EU","SG_BUFF_REC_EU"]),Object.freeze(["BUFF_RED","BUFF_RED_ARROW","BUFF_HPUP","BUFF_ELEMENTALHPUP","BUFF_ELEMENTALCRTRATEUP","BUFF_ELEMENTALATKUP","BUFF_ELEMENTALDEFUP","BUFF_ELEMENTALRECUP","BUFF_HCREC","BUFF_ALLAILNULL","BUFF_HPTHRESHGENERIC","BUFF_BBTHRESHGENERIC","BUFF_GENERICDROP","BUFF_ALLDMGDOWN"]),ae.map((function(e){return"DEBUFF_".concat(e.toUpperCase())})),Object.freeze({SELF:"self",PARTY:"party",ENEMY:"enemy",OTHER:"other"}),Object.freeze({PASSIVE:"passive",PROC:"proc",BURST:"burst"}),Object.freeze({hp_50pr_under:"has less than 50% HP",hp_50pr_over:"has more than 50% HP",hp_75pr_under:"has less than 75% HP",hp_25pr_under:"has less than 25% HP",hp_min:"has the lowest HP",hp_max:"has the highest HP",atk_max:"has the highest attack",random:"is present"}),Object.freeze({skill:"use BB/SBB",attack:"normal attack"}),Object.freeze({party:"when an ally",enemy:"on enemy that"}),Object.freeze({"unit.ls":"Leader Skill","unit.es":"Extra Skill","unit.bb":"Brave Burst","unit.sbb":"Super Brave Burst","unit.ubb":"Ultimate Brave Burst","unit.sp":"SP Enhancement"}),Object.freeze({unit:{ls:{background:"green darken-3",text:"green lighten-5"},es:{background:"orange darken-4",text:"orange lighten-5"},bb:{background:"blue-grey",text:"blue-grey lighten-5"},sbb:{background:"yellow darken-3",text:"yellow lighten-5"},ubb:{background:"red darken-3",text:"red lighten-5"},sp:{background:"light-green darken-3",text:"light-green lighten-5"}}}),Object.freeze({unit:{name:"Unit",multidexKey:"units",key:"unit"},item:{name:"Sphere",multidexKey:"items",key:"item"},bb:{name:"Burst",multidexKey:"bursts",key:"bb"},es:{name:"Extra Skill",multidexKey:"extraSkills",key:"es"},ls:{name:"Leader Skill",multidexKey:"leaderSkills",key:"ls"}});function se(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e["triggered effect"]||[]}function le(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Array.from(e.effects||e.effect&&e.effect.effect||e.effect||[]);return t.concat(t.map(se).reduce((function(e,t){return Array.isArray(t)?e.concat(t):e.concat([t])}),[]))}function fe(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e){return le(e)},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(e){return le(e)};if(0===t.length&&0===n.length)return!0;var o=0===t.length;if(!o){var u=r(e).map((function(e){return e["proc id"]||e["unknown proc id"]})).filter((function(e){return e})).map((function(e){return+e}));o=t.every((function(e){return u.includes(+e)}))}var a=0===n.length;if(!a){var c=i(e).map((function(e){return e["passive id"]||e["unknown passive id"]})).filter((function(e){return e})).map((function(e){return+e}));a=n.every((function(e){return c.includes(+e)}))}return o&&a}function he(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=[];return e.skill&&e.skill.effects&&e.skill.effects.forEach((function(e){Object.keys(e).forEach((function(n){t.push(e[n])}))})),t.concat(t.map(se).reduce((function(e,t){return Array.isArray(t)?e.concat(t):e.concat([t])}),[]))}function de(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e&&e.levels&&e.levels[e.levels.length-1];return le(t||{})}var ve={ls:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return le(e["leader skill"])},es:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return le(e["extra skill"])},sp:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.feskills)return[];var t=e.feskills.map(he).reduce((function(e,t){return e.concat(t)}),[]);return t},bb:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.bb?de(e.bb):[]},sbb:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.sbb?de(e.sbb):[]},ubb:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.ubb?de(e.ubb):[]}};function pe(e,t){return(ve[t]||le)(e)}function ye(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.split("|").filter((function(e,t){return 0===t||e.trim()})).map((function(e){return e.toLowerCase()}))}function me(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ee;return n.isAll(t)||n.isTruthy(t)&&e||n.isFalsy(t)&&!e}var ge=Object.freeze({ID:function(e,t){return+e-+t},Alphabetical:function(e,t,n){var r=[n(e),n(t)],i=r[0],o=r[1];return i>o?1:-1},Numerical:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ge.ID,i=[n(e),n(t)],o=i[0],u=i[1];return o!==u?o-u:r(e,t)}});function be(e){var t=e.input,n=void 0===t?[]:t,r=e.sortFn,i=void 0===r?ge.ID:r,o=e.isAscending,u=void 0===o||o;return n.sort((function(e,t){var n=i(e,t);return u?n:-n}))}function _e(e,t,n,r,i,o,u){try{var a=e[o](u),c=a.value}catch(s){return void n(s)}a.done?t(c):Promise.resolve(c).then(r,i)}function Fe(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function u(e){_e(o,r,i,u,a,"next",e)}function a(e){_e(o,r,i,u,a,"throw",e)}u(void 0)}))}}function we(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if("undefined"===typeof t||0===Object.keys(t).length)return Object.keys(e);var n=t.keys,r=void 0===n?Object.keys(e):n,i=t.procs,o=void 0===i?[]:i,u=t.passives,a=void 0===u?[]:u;return r.filter((function(t){return e.hasOwnProperty(t)&&fe(e[t],o,a)}))}function ke(e){return Ee.apply(this,arguments)}function Ee(){return Ee=Fe(u.a.mark((function e(t){var n,r,i,o,a=arguments;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=a.length>1&&void 0!==a[1]?a[1]:"gl",r=a.length>2?a[2]:void 0,i=a.length>3&&void 0!==a[3]?a[3]:we,e.next=5,r.get({table:t,query:{server:n}});case 5:if(o=e.sent,0!==o.length&&o[0].data&&0!==Object.keys(o[0].data).length){e.next=10;break}return e.abrupt("return",{keys:[],fullDb:{}});case 10:return e.abrupt("return",{keys:i(o[0].data),fullDb:o[0].data});case 11:case"end":return e.stop()}}),e)}))),Ee.apply(this,arguments)}function Ue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gl",n=arguments.length>2?arguments[2]:void 0;return ke("units",t,n,(function(t){if("undefined"===typeof e||0===Object.keys(e).length)return Object.keys(t);var n=e.keys,r=void 0===n?Object.keys(t):n,i=e.procBuffSearchOptions,o=void 0===i?ue.slice():i,u=e.passiveBuffSearchOptions,a=void 0===u?ue.slice():u,c=e.procs,s=void 0===c?[]:c,l=e.passives,f=void 0===l?[]:l,h=e.name,d=void 0===h?"":h,v=e.elements,p=void 0===v?Q.slice():v,y=e.rarity,m=void 0===y?new Array(8).fill(0).map((function(e,t){return t+1})):y,g=e.unitKinds,b=void 0===g?J.slice():g,_=e.genders,F=void 0===_?X.slice():_,w=ye(d),k=function(e){return fe(e,s,f,(function(e){return o.map((function(t){return pe(e,t)})).reduce((function(e,t){return e.concat(t)}),[])}),(function(e){return a.map((function(t){return pe(e,t)})).reduce((function(e,t){return e.concat(t)}),[])}))},E=function(e){var n=t[e],r=!d||w.some((function(e){return n.name.toLowerCase().includes(e)})),i=!d||w.some((function(t){return e.toString().toLowerCase().includes(t)||(n.id||"").toString().includes(t)})),o=p.includes(n.element),u=m.includes(n.rarity),a=F.includes(n.gender),c=("evo"===n.kind?"enhancing":"enhancing"===n.kind?"evolution":n.kind)||"enhancing",s=b.includes(c);return[r||i,o,u,s,a].every((function(e){return e}))};return r.filter((function(e){return t.hasOwnProperty(e)&&k(t[e])&&E(e)}))}))}function Be(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gl",n=arguments.length>2?arguments[2]:void 0;return ke("items",t,n,(function(t){if("undefined"===typeof e||0===Object.keys(e).length)return Object.keys(t);var n=e.keys,r=void 0===n?Object.keys(t):n,i=e.procs,o=void 0===i?[]:i,u=e.passives,a=void 0===u?[]:u,c=e.name,s=void 0===c?"":c,l=e.rarity,f=void 0===l?new Array(9).fill(0).map((function(e,t){return t})):l,h=e.itemTypes,d=void 0===h?$.slice():h,v=e.sphereTypes,p=void 0===v?Object.keys(re).map((function(e,t){return t})):v,y=e.associatedUnits,m=void 0===y?ee.allValue:y,g=e.craftables,b=void 0===g?te.allValue:g,_=e.usage,F=void 0===_?ne.allValue:_,w=ye(s),k=p.includes(0),E=15===p.length,U=function(e){var n=t[e],r=!s||w.some((function(e){return n.name.toLowerCase().includes(e)})),i=!s||w.some((function(t){return e.toString().toLowerCase().includes(t)||(n.id||"").toString().includes(t)})),o=f.includes(n.rarity),u=d.includes(n.type)||d.includes("raid")&&n.raid,a=void 0!==n["sphere type"]||"sphere"===n.type||"ls_sphere"===n.type,c=E||a&&p.includes(n["sphere type"])||k&&!n["sphere type"],l=Array.isArray(n.associated_units)&&n.associated_units.length>0,h=me(l,m),v=!!n.recipe,y=me(v,b,te),g=!!n.usage&&n.usage.length>0,_=me(g,F,ne);return[r||i,u,o,c,h,y,_].every((function(e){return e}))};return r.filter((function(e){return t.hasOwnProperty(e)&&fe(t[e],o,a)&&U(e)}))}))}function Oe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gl",n=arguments.length>2?arguments[2]:void 0;return ke("bursts",t,n,(function(t){if("undefined"===typeof e||0===Object.keys(e).length)return Object.keys(t);var n=e.keys,r=void 0===n?Object.keys(t):n,i=e.procs,o=void 0===i?[]:i,u=e.passives,a=void 0===u?[]:u,c=e.name,s=void 0===c?"":c,l=e.associatedUnits,f=void 0===l?ee.allValue:l,h=ye(s),d=function(e){return fe(e,o,a,(function(e){return de(e)}),(function(e){return de(e)}))},v=function(e){var n=t[e],r=!s||h.some((function(e){return n.name.toLowerCase().includes(e)})),i=!s||h.some((function(t){return e.toString().toLowerCase().includes(t)||(n.id||"").toString().includes(t)})),o=Array.isArray(n.associated_units)&&n.associated_units.length>0,u=me(o,f,ee);return[r||i,u].every((function(e){return e}))};return r.filter((function(e){return t.hasOwnProperty(e)&&d(t[e])&&v(e)}))}))}function Ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gl",n=arguments.length>2?arguments[2]:void 0;return ke("extraSkills",t,n,(function(t){if("undefined"===typeof e||0===Object.keys(e).length)return Object.keys(t);var n=e.keys,r=void 0===n?Object.keys(t):n,i=e.procs,o=void 0===i?[]:i,u=e.passives,a=void 0===u?[]:u,c=e.name,s=void 0===c?"":c,l=e.rarity,f=void 0===l?new Array(9).fill(0).map((function(e,t){return t})):l,h=e.associatedUnits,d=void 0===h?ee.allValue:h,v=ye(s),p=function(e){return fe(e,o,a)},y=function(e){var n=t[e],r=!s||v.some((function(e){return n.name.toLowerCase().includes(e)})),i=!s||v.some((function(t){return e.toString().toLowerCase().includes(t)||(n.id||"").toString().includes(t)})),o=f.includes(+n.rarity),u=Array.isArray(n.associated_units)&&n.associated_units.length>0,a=me(u,d,ee);return[r||i,o,a].every((function(e){return e}))};return r.filter((function(e){return t.hasOwnProperty(e)&&p(t[e])&&y(e)}))}))}function De(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gl",n=arguments.length>2?arguments[2]:void 0;return ke("leaderSkills",t,n,(function(t){if("undefined"===typeof e||0===Object.keys(e).length)return Object.keys(t);var n=e.keys,r=void 0===n?Object.keys(t):n,i=e.procs,o=void 0===i?[]:i,u=e.passives,a=void 0===u?[]:u,c=e.name,s=void 0===c?"":c,l=e.associatedUnits,f=void 0===l?ee.allValue:l,h=ye(s),d=function(e){return fe(e,o,a)},v=function(e){var n=t[e],r=!s||h.some((function(e){return n.name.toLowerCase().includes(e)})),i=!s||h.some((function(t){return e.toString().toLowerCase().includes(t)||(n.id||"").toString().includes(t)})),o=Array.isArray(n.associated_units)&&n.associated_units.length>0,u=me(o,f,ee);return[r||i,u].every((function(e){return e}))};return r.filter((function(e){return t.hasOwnProperty(e)&&d(t[e])&&v(e)}))}))}function xe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gl",n=arguments.length>2?arguments[2]:void 0;return ke("missions",t,n,(function(t){if("undefined"===typeof e||0===Object.keys(e).length)return Object.keys(t);var n=e.keys,r=void 0===n?Object.keys(t):n,i=e.name,o=void 0===i?"":i,u=e.associatedUnits,a=void 0===u?ee.allValue:u,c=e.associatedItems,s=void 0===c?ee.allValue:c,l=e.gems,f=void 0===l?ee.allValue:l,h=e.continues,d=void 0===h?ee.allValue:h,v=ye(o),p=function(n){var r=t[n],i=!o||v.some((function(e){return r.name.toLowerCase().includes(e)})),u=!o||v.some((function(e){return n.toString().toLowerCase().includes(e)||(r.id||"").toString().includes(e)})),c=Array.isArray(r.clear_bonus)&&r.clear_bonus.some((function(e){return!!e.unit})),l=me(c,a,ee),h=Array.isArray(r.clear_bonus)&&r.clear_bonus.some((function(e){return!!e.item})),p=me(h,s,ee),y=Array.isArray(r.clear_bonus)&&r.clear_bonus.some((function(e){return!!e.gem})),m=me(y,f,ee),g=!!r.continue,b=me(g,d,ee),_=Z.every((function(t){var n=e[t]||[];return 0===n.length||n.includes(r[t])}));return[i||u,l,p,m,_,b].every((function(e){return e}))};return r.filter((function(e){return t.hasOwnProperty(e)&&p(e)}))}))}function Pe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"gl",n=arguments.length>2?arguments[2]:void 0;return ke("dictionary",t,n,(function(t){if("undefined"===typeof e||0===Object.keys(e).length)return Object.keys(t);var n=e.keys,r=void 0===n?Object.keys(t):n,i=e.name,o=void 0===i?"":i,u=ye(o),a=function(e){var n=t[e],r=!o||u.some((function(e){return n.toLowerCase().includes(e)})),i=!o||u.some((function(t){return e.toString().toLowerCase().includes(t)}));return[r||i].every((function(e){return e}))};return r.filter((function(e){return t.hasOwnProperty(e)&&a(e)}))}))}function Se(e){var t=e.keys,n=void 0===t?[]:t,r=e.sortOptions,i=void 0===r?{}:r,o=e.sortTypes,u=void 0===o?{}:o,a=i.type,c=void 0===a?"ID":a,s=i.isAscending,l=void 0===s||s;return be({input:n,sortFn:u[c],isAscending:l})}var Te=function(e){var t=0;return Array.isArray(e)&&(t=e.reduce((function(e,t){return e+ +t.hits*("AOE"===t.target?6:1)}),0)),t},Re=function(e){return Array.isArray(e)?e.length:0};function Ie(e){var t=e.keys,n=e.db,r=e.sortOptions;return Se({keys:t,sortOptions:r,sortTypes:{"Unit ID":ge.ID,"Guide ID":function(e,t){return ge.Numerical(e,t,(function(e){return+n[e].guide_id}))},Alphabetical:function(e,t){return ge.Alphabetical(e,t,(function(e){return n[e].name}))},Rarity:function(e,t){return ge.Numerical(e,t,(function(e){return+n[e].rarity}))},Elements:function(e,t){return ge.Numerical(e,t,(function(e){return Q.indexOf(n[e].element)}))},"Normal Attack Hit Count":function(e,t){return ge.Numerical(e,t,(function(e){return Te(n[e].attackInfo&&n[e].attackInfo.normal)}))},"Attack Count on BB":function(e,t){return ge.Numerical(e,t,(function(e){return Re(n[e].attackInfo&&n[e].attackInfo.bb)}),(function(e,t){return ge.Numerical(e,t,(function(e){return Te(n[e].attackInfo&&n[e].attackInfo.bb)}))}))},"Attack Count on SBB":function(e,t){return ge.Numerical(e,t,(function(e){return Re(n[e].attackInfo&&n[e].attackInfo.sbb)}),(function(e,t){return ge.Numerical(e,t,(function(e){return Te(n[e].attackInfo&&n[e].attackInfo.sbb)}))}))},"Attack Count on UBB":function(e,t){return ge.Numerical(e,t,(function(e){return Re(n[e].attackInfo&&n[e].attackInfo.ubb)}),(function(e,t){return ge.Numerical(e,t,(function(e){return Te(n[e].attackInfo&&n[e].attackInfo.ubb)}))}))}}})}function je(e){var t=e.keys,n=e.db,r=e.sortOptions;return Se({keys:t,sortOptions:r,sortTypes:{"Item ID":ge.ID,Alphabetical:function(e,t){return ge.Alphabetical(e,t,(function(e){return n[e].name}))},Rarity:function(e,t){return ge.Numerical(e,t,(function(e){return+n[e].rarity}))},Type:function(e,t){return ge.Numerical(e,t,(function(e){return $.indexOf(n[e].type)}))},"Sell Price":function(e,t){return ge.Numerical(e,t,(function(e){return+n[e].sell_price}))}}})}function Ne(e){var t=e.keys,n=e.db,r=e.sortOptions;return Se({keys:t,sortOptions:r,sortTypes:{"Burst ID":ge.ID,Alphabetical:function(e,t){return ge.Alphabetical(e,t,(function(e){return n[e].name}))},"Attack Count":function(e,t){return ge.Numerical(e,t,(function(e){return Re(n[e].attackInfo)}),(function(e,t){return ge.Numerical(e,t,(function(e){return Te(n[e].attackInfo)}))}))}}})}function Ce(e){var t=e.keys,n=e.db,r=e.sortOptions;return Se({keys:t,sortOptions:r,sortTypes:{"Skill ID":ge.ID,Alphabetical:function(e,t){return ge.Alphabetical(e,t,(function(e){return n[e].name}))},Rarity:function(e,t){return ge.Numerical(e,t,(function(e){return+n[e].rarity}))}}})}function Le(e){var t=e.keys,n=e.db,r=e.sortOptions;return Se({keys:t,sortOptions:r,sortTypes:{"Skill ID":ge.ID,Alphabetical:function(e,t){return ge.Alphabetical(e,t,(function(e){return n[e].name}))}}})}function Ke(e){var t=e.keys,n=e.db,r=e.sortOptions,i=void 0===r?{}:r,o=i.possibleValues,u=void 0===o?{land:[],area:[],dungeon:[]}:o,a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e/Math.max(1,t)};return Se({keys:t,sortOptions:i,sortTypes:{"Mission ID":ge.ID,Alphabetical:function(e,t){return ge.Alphabetical(e,t,(function(e){return n[e].name}))},Energy:function(e,t){return ge.Numerical(e,t,(function(e){return+n[e].energy_use}))},"Battle Count":function(e,t){return ge.Numerical(e,t,(function(e){return+n[e].battle_count}))},Rarity:function(e,t){return ge.Numerical(e,t,(function(e){return+n[e].rarity}))},Map:function(e,t){var r,i,o=[n[e],n[t]],a=o[0],c=o[1],s=a.land,l=a.area,f=a.dungeon,h=c.land,d=c.area,v=c.dungeon;if(s===h)if(l===d){var p=[u.dungeon.indexOf(f),u.dungeon.indexOf(v)];r=p[0],i=p[1]}else{var y=[u.area.indexOf(l),u.area.indexOf(d)];r=y[0],i=y[1]}else{var m=[u.land.indexOf(s),u.land.indexOf(h)];r=m[0],i=m[1]}return r!==i?r-i:ge.ID(e,t)},XP:function(e,t){return ge.Numerical(e,t,(function(e){return+n[e].xp}))},"XP/EN":function(e,t){return ge.Numerical(e,t,(function(e){return a(+n[e].xp,+n[e].energy_use)}))}}})}function Me(e){var t=e.keys,n=e.db,r=e.sortOptions;return Se({keys:t,sortOptions:r,sortTypes:{"Dictionary ID":ge.ID,Alphabetical:function(e,t){return ge.Alphabetical(e,t,(function(e){return n[e]}))}}})}function We(e){return We="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},We(e)}function He(e,t){return Ye(e)||ze(e,t)||qe(e,t)||Ge()}function Ge(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function qe(e,t){if(e){if("string"===typeof e)return Ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ve(e,t):void 0}}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ze(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var u,a=e[Symbol.iterator]();!(r=(u=a.next()).done);r=!0)if(n.push(u.value),t&&n.length===t)break}catch(c){i=!0,o=c}finally{try{r||null==a["return"]||a["return"]()}finally{if(i)throw o}}return n}}function Ye(e){if(Array.isArray(e))return e}function Qe(e,t,n,r,i,o,u){try{var a=e[o](u),c=a.value}catch(s){return void n(s)}a.done?t(c):Promise.resolve(c).then(r,i)}function Xe(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function u(e){Qe(o,r,i,u,a,"next",e)}function a(e){Qe(o,r,i,u,a,"throw",e)}u(void 0)}))}}function Je(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ze(e,t,n){return t&&$e(e.prototype,t),n&&$e(e,n),e}function et(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tt(e,t)}function tt(e,t){return tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},tt(e,t)}function nt(e){return function(){var t,n=ut(e);if(ot()){var r=ut(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return rt(this,t)}}function rt(e,t){return!t||"object"!==We(t)&&"function"!==typeof t?it(e):t}function it(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ot(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function ut(e){return ut=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ut(e)}var at=Y.map((function(e){var t=e.name;return t})),ct=function(e){et(n,e);var t=nt(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new O["a"];return Je(this,n),e=t.call(this),e._db=r,e}return Ze(n,[{key:"put",value:function(e){var t=e.table,n=void 0===t?"":t,r=e.entry;return this._db[n].put(r)}},{key:"get",value:function(e){var t=this,n=e.table,r=void 0===n?"":n,i=e.query;return Promise.resolve().then((function(){return t._db[r].where(i).toArray()})).catch((function(e){return N.error("GET error. Returning default value: []",{table:r,query:i},e),[]}))}},{key:"getAll",value:function(e){var t=this,n=e.table;return Promise.resolve().then((function(){return t._db[n].toArray()})).catch((function(e){return N.error("GET error. Returning default value: []",{table:n},e),[]}))}},{key:"delete",value:function(e){var t=e.table,n=e.key;return this._db[t].delete(n)}},{key:"getFieldInEntry",value:function(){var e=Xe(u.a.mark((function e(t){var n,r,i,o,a,c;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.table,r=void 0===n?"":n,i=t.query,o=t.field,a=void 0===o?"":o,e.next=3,this.get({table:r,query:i});case 3:return c=e.sent,e.abrupt("return",0===c.length?void 0:c[0][a]);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getFieldKeys",value:function(){var e=Xe(u.a.mark((function e(t){var n,r,i,o,a;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.table,r=void 0===n?"":n,i=t.query,o=t.field,e.next=3,this.get({table:r,query:i});case 3:return a=e.sent,e.abrupt("return",0===a.length?[]:Object.keys(a[0][o]));case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getByIds",value:function(){var e=Xe(u.a.mark((function e(t){var n,r,i,o,a,c,s,l,f,h,d,v;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.table,r=void 0===n?"":n,i=t.query,o=t.field,a=t.ids,c=void 0===a?[]:a,s=t.extractedFields,l=void 0===s?[]:s,e.next=3,this.get({table:r,query:i});case 3:return f=e.sent,h={},void 0!==f[0]&&void 0!==f[0][o]&&(d=f[0][o],c.forEach((function(e){if(void 0!==d[e]){var t=d[e];if(0===l.length)h[e]=t;else{var n={};l.forEach((function(e){t.hasOwnProperty(e)&&(n[e]=t[e])})),h[e]=n}}}))),v=Object.keys(h).length,c.length!==v?N.warn("input[".concat(c.length," keys]; output[").concat(v," keys]")):N.debug("input[".concat(c.length," keys]; output[").concat(v," keys]")),e.abrupt("return",h);case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getById",value:function(){var e=Xe(u.a.mark((function e(t){var n,r,i,o,a,c;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.table,r=void 0===n?"":n,i=t.query,o=t.field,a=t.id,e.next=3,this.getByIds({table:r,query:i,field:o,ids:[a]});case 3:return c=e.sent,e.abrupt("return",c[a]);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getDbStats",value:function(){var e=Xe(u.a.mark((function e(t){var n,r,i,o,a,c,s;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.table,r=void 0===n?"":n,i=t.query,e.next=3,this.get({table:r,query:i});case 3:if(o=e.sent,!(o.length>0)){e.next=13;break}return e.prev=5,a=o[0],c=a.updateTime,s=a.cacheTime,e.abrupt("return",{keyLength:Object.keys(o[0].data).length,updateTime:c,cacheTime:s});case 10:e.prev=10,e.t0=e["catch"](5),N.error(e.t0);case 13:return e.abrupt("return",void 0);case 14:case"end":return e.stop()}}),e,this,[[5,10]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getTablesWithEntries",value:function(){var e=Xe(u.a.mark((function e(t){var n,r,i,o,a,c=this;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.tables,r=void 0===n?[]:n,i=t.server,o=function(e){return c.getDbStats({table:e,query:{server:i}}).then((function(t){return{table:e,count:t&&t.keyLength||0}}))},e.next=4,Promise.all(r.map(o));case 4:return a=e.sent,N.debug(a),e.abrupt("return",a.filter((function(e){var t=e.count;return t>0})).map((function(e){var t=e.table;return t})));case 7:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getTablesWithUpdates",value:function(){var e=Xe(u.a.mark((function e(t){var n,r,i,o,a,c,s,l,f,h=this;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.tables,r=void 0===n?[]:n,i=t.server,o=t.sourceUrl,a=function(e){return h.getDbStats({table:e,query:{server:i}}).then((function(t){return{table:e,updateTime:new Date(t&&t.updateTime||0),count:t&&t.keyLength||0}}))},e.next=4,Promise.all([Promise.all(r.map(a)),fetch(o).then((function(e){return e.ok?e.json():Promise.reject(e.statusText)}))]);case 4:return c=e.sent,s=He(c,2),l=s[0],f=s[1],N.debug({dateMapping:l,updateTimes:f}),e.abrupt("return",l.filter((function(e){return e.updateTime&&f[e.table]&&f[e.table][i]&&(e.count<=0||new Date(f[e.table][i])>new Date(e.updateTime))})).map((function(e){var t=e.table;return t})));case 10:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getFilteredDb",value:function(){var e=Xe(u.a.mark((function e(t){var n,o,a,c,s,l,f,h,d,v,p,y,m;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.table,o=void 0===n?"":n,a=t.filters,c=t.server,s=void 0===c?"gl":c,l=t.extractedFields,f=t.sortOptions,h=!Array.isArray(l),!at.includes(o)){e.next=22;break}return e.next=5,r[o](a,s,this);case 5:if(d=e.sent,v=d.keys,p=d.fullDb,!h){e.next=12;break}return e.abrupt("return","object"===We(f)?i[o]({keys:v,db:p,sortOptions:f}):v);case 12:if(0!==l.length){e.next=18;break}return y={},v.forEach((function(e){return y[e]=!0})),e.abrupt("return",y);case 18:return m=1===l.length&&"*"===l[0],e.abrupt("return",this.getByIds({table:o,query:{server:s},ids:v,extractedFields:m?[]:l,field:"data"}));case 20:e.next=24;break;case 22:return N.error("Table not found [".concat(o,"]")),e.abrupt("return",h?[]:{});case 24:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getSortedKeys",value:function(){var e=Xe(u.a.mark((function e(t){var n,r,o,a,c,s,l,f,h;return u.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.table,r=void 0===n?"":n,o=t.sortOptions,a=void 0===o?{}:o,c=t.server,s=void 0===c?"gl":c,l=t.keys,f=void 0===l?[]:l,e.next=3,this.get({table:r,query:{server:s}});case 3:if(h=e.sent,0!==h.length&&h[0].data&&0!==Object.keys(h[0].data).length){e.next=9;break}return N.warn("no table found for [".concat(r,"]. Returning input keys back.")),e.abrupt("return",f);case 9:return e.abrupt("return",i[r]({keys:f,db:h[0].data,sortOptions:a}));case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),n}(P),st=new O["a"]("bf-mt"),lt={1:"&server,data,updateTime",2:"&server,data,updateTime,cacheTime"};st.version(1).stores({units:lt[1],items:lt[1],bursts:lt[1],extraSkills:lt[1],leaderSkills:lt[1],settings:"&user,data"}),st.version(2).stores({units:lt[2],items:lt[2],bursts:lt[2],extraSkills:lt[2],leaderSkills:lt[2]}).upgrade((function(e){return N.debug("[DEXIE] using schema version 2"),e})),st.version(3).stores({missions:lt[2],dictionary:lt[2]}).upgrade((function(e){return N.debug("[DEXIE] using schema version 3"),e})),st.version(4).stores({commmits:"&branch,data"}).upgrade((function(e){return N.debug("[DEXIE] using schema version 4"),e})),st.version(4.1).stores({commmits:null,commits:"&user,data"}).upgrade((function(e){return N.debug("[DEXIE] using schema version 4.1"),e})),st.version(5).stores({squads:"++id,squad"}),st.version(5.1).stores({squads:"++id,server,squad"});var ft=st;function ht(e,t,n,r,i,o,u){try{var a=e[o](u),c=a.value}catch(s){return void n(s)}a.done?t(c):Promise.resolve(c).then(r,i)}function dt(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function u(e){ht(o,r,i,u,a,"next",e)}function a(e){ht(o,r,i,u,a,"throw",e)}u(void 0)}))}}var vt=new ct(ft),pt=new B;function yt(){var e=Object.getOwnPropertyNames(Object.getPrototypeOf(vt)).filter((function(e){return!e.startsWith("_")&&"constructor"!==e}));N.debug("adding handlers for dbApi methods",e),e.forEach((function(e){pt.registerCommand(e,function(){var t=dt(u.a.mark((function t(n){var r;return u.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return N.debug("got command",{method:e,data:n}),t.next=3,Promise.resolve().then((function(){return vt[e](n)}));case 3:return r=t.sent,N.debug("got result",{method:e,result:r}),t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())})),N.debug("worker initialized")}pt.registerCommand("ping",(function(e){return"Pong ".concat(e.from)})),pt.registerCommand("delayed-ping",(function(e){return setTimeout((function(){pt.request("message",{message:"Delayed Pong ".concat(e.from)})}),5e3),"Immediate Pong ".concat(e.from)})),yt()}});
//# sourceMappingURL=11987cf3bf4c5977902e.worker.js.map